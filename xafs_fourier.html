
<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>14.5. XAFS: Fourier Transforms for XAFS &#8212; xraylarch 2025.3.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/larchdoc.css?v=dfcb3266" />
    
    <script src="_static/documentation_options.js?v=865d4376"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="14.6. XAFS: Wavelet Transforms for XAFS" href="xafs_wavelets.html" />
    <link rel="prev" title="14.4. XAFS: Post-edge Background Subtraction" href="xafs_autobk.html" />

<script async src="https://badge.dimensions.ai/badge.js" charset="utf-8"></script>

<script type="text/x-mathjax-config">
   MathJax.Hub.Config({ "TeX": {Macros: {AA : "{\\unicode{x212B}}"}}, "HTML-CSS": {scale: 90}});
</script>


  </head><body>
<div style=" color: #c5daba;  text-align: left; height:65px; padding: 0px">
<table border=0>
  <tr>
    <td width=20%>
	<a href="index.html">
	 <img src="_static/larchcones.png" height=50px alt="larchcones"/></a>
    </td>
    <td width=75% padding=0>
      <font size=+2>
	<a href="index.html" style="color:#772211">
	  Larch: Data Analysis Tools for X-ray Spectroscopy
	</a>
      </font>
    </td>
   </tr></table>
</div>

    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="xafs_wavelets.html" title="14.6. XAFS: Wavelet Transforms for XAFS"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="xafs_autobk.html" title="14.4. XAFS: Post-edge Background Subtraction"
             accesskey="P">previous</a> |</li>
   <li>[<a href="index.html"> Larch</a>|</li>
   <li><a href="getting_started.html"> Getting Started</a>|</li>
   <li><a href="xafs.html">XAFS Analysis</a>|</li>
   <li><a href="xray.html">X-ray Databases</a>|</li>
   <li><a href="xrf.html">XRF Analysis</a>|</li>

          <li class="nav-item nav-item-1"><a href="xafs.html" accesskey="U"><span class="section-number">14. </span>XAFS Analysis</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">14.5. </span>XAFS: Fourier Transforms for XAFS</a></li> 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">14.5. XAFS: Fourier Transforms for XAFS</a><ul>
<li><a class="reference internal" href="#overview-of-xafs-fourier-transforms">14.5.1. Overview of XAFS Fourier transforms</a></li>
<li><a class="reference internal" href="#forward-xafs-fourier-transforms-k-rightarrow-r">14.5.2. Forward XAFS Fourier transforms (<span class="math notranslate nohighlight">\(k{\rightarrow}R\)</span>)</a><ul>
<li><a class="reference internal" href="#xftf"><code class="docutils literal notranslate"><span class="pre">xftf()</span></code></a></li>
<li><a class="reference internal" href="#xftf_fast"><code class="docutils literal notranslate"><span class="pre">xftf_fast()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#reverse-xafs-fourier-transforms-r-rightarrow-q">14.5.3. Reverse XAFS Fourier transforms (<span class="math notranslate nohighlight">\(R{\rightarrow}q\)</span>)</a><ul>
<li><a class="reference internal" href="#xftr"><code class="docutils literal notranslate"><span class="pre">xftr()</span></code></a></li>
<li><a class="reference internal" href="#xftr_fast"><code class="docutils literal notranslate"><span class="pre">xftr_fast()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#ftwindow-generating-fourier-transform-windows">14.5.4. <code class="xref py py-func docutils literal notranslate"><span class="pre">ftwindow()</span></code>: Generating Fourier transform windows</a><ul>
<li><a class="reference internal" href="#ftwindow"><code class="docutils literal notranslate"><span class="pre">ftwindow()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#catalog-of-fourier-transform-window">14.5.5. Catalog of Fourier transform window</a></li>
<li><a class="reference internal" href="#examples-forward-xafs-fourier-transforms">14.5.6. Examples: Forward XAFS Fourier transforms</a></li>
<li><a class="reference internal" href="#examples-reverse-xafs-fourier-transforms-fourier-filtering">14.5.7. Examples: Reverse XAFS Fourier transforms, Fourier Filtering</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="xafs_autobk.html"
                          title="previous chapter"><span class="section-number">14.4. </span>XAFS: Post-edge Background Subtraction</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="xafs_wavelets.html"
                          title="next chapter"><span class="section-number">14.6. </span>XAFS: Wavelet Transforms for XAFS</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/xafs_fourier.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <p><span class="math notranslate nohighlight">\(\newcommand{\AA}{\unicode{x212B}}\)</span></p>
<section id="xafs-fourier-transforms-for-xafs">
<span id="xafs-ft-sec"></span><h1><span class="section-number">14.5. </span>XAFS: Fourier Transforms for XAFS<a class="headerlink" href="#xafs-fourier-transforms-for-xafs" title="Link to this heading">¶</a></h1>
<p>Fourier transforms are central to understanding and using
XAFS. Consequently, many of the XAFS functions in Larch use XAFS Fourier
transforms as part of their processing, and many of the functions
parameters and arguments described here have names and meanings used
throughout the XAFS functionality of Larch.  For example, both
<a class="reference internal" href="xafs_autobk.html#autobk" title="autobk"><code class="xref py py-func docutils literal notranslate"><span class="pre">autobk()</span></code></a> and <a class="reference internal" href="xafs_feffit.html#id0" title="feffit"><code class="xref py py-func docutils literal notranslate"><span class="pre">feffit()</span></code></a> rely on XAFS Fourier transforms, and use
the XAFS Fourier transform function described here.</p>
<section id="overview-of-xafs-fourier-transforms">
<h2><span class="section-number">14.5.1. </span>Overview of XAFS Fourier transforms<a class="headerlink" href="#overview-of-xafs-fourier-transforms" title="Link to this heading">¶</a></h2>
<p>The standard Fourier transform of a signal <span class="math notranslate nohighlight">\(f(t)\)</span> can be written as</p>
<div class="math notranslate nohighlight">
\begin{eqnarray*}
      {\tilde{f}}(\omega) &amp;=&amp; \frac{1}{\sqrt{2\pi}} \int_{-\infty}^{\infty}
    f(t) e^{-i{\omega}t} dt \\
    f(t) &amp;=&amp; \frac{1}{\sqrt{2\pi}} \int_{-\infty}^{\infty}
    {\tilde{f}}(\omega) e^{i{\omega}t} d{\omega} \\
\end{eqnarray*}</div><p>where the symmetric normalization is one of the more common choices of
conventions.  This gives conjugate variables of <span class="math notranslate nohighlight">\(\omega\)</span> and
<span class="math notranslate nohighlight">\(t\)</span>. Because XAFS goes as</p>
<div class="math notranslate nohighlight">
\[\chi(k) \sim \sin[2kR + \delta(k)]\]</div>
<p>the conjugate variables in XAFS are generally taken to be <span class="math notranslate nohighlight">\(k\)</span> and
<span class="math notranslate nohighlight">\(2R\)</span>.  The normalization of <span class="math notranslate nohighlight">\(\tilde\chi(R)\)</span> from a Fourier
transform of <span class="math notranslate nohighlight">\(\chi(k)\)</span> is a matter of convention, but we follow the
symmetric case above (with <span class="math notranslate nohighlight">\(t\)</span> replaced by <span class="math notranslate nohighlight">\(k\)</span> and
<span class="math notranslate nohighlight">\(\omega\)</span> replaced by <span class="math notranslate nohighlight">\(2R\)</span>, and of course <span class="math notranslate nohighlight">\(f\)</span> by
<span class="math notranslate nohighlight">\(\chi\)</span>).</p>
<p>But there are two more important issues to mention.  First, an XAFS Fourier
transform multiplies <span class="math notranslate nohighlight">\(\chi(k)\)</span> by a power of <span class="math notranslate nohighlight">\(k\)</span>, <span class="math notranslate nohighlight">\(k^n\)</span>
and by a window function <span class="math notranslate nohighlight">\(\Omega(k)\)</span> before doing the Fourier
transform.  The power-law weighting allow the oscillations in <span class="math notranslate nohighlight">\(k\)</span> to
emphasize different portions of the spectra, or to give a uniform intensity
to the oscillations.  The window function acts to smooth the resulting
Fourier transform and remove ripple and ringing in it that would result
from a sudden truncation of <span class="math notranslate nohighlight">\(\chi(k)\)</span> at the end of the data range.</p>
<p>The second important issue is that the continuous Fourier transform
described above is replaced by a discrete transform.  This better matches
the discrete sampling of energy and <span class="math notranslate nohighlight">\(k\)</span> values of the data, and
allows Fast Fourier Transform techniques to be used.  It does change the
definitions of the transforms used somewhat. First, the <span class="math notranslate nohighlight">\(\chi(k)\)</span>
data must be on <em>uniformly spaced</em> set of <span class="math notranslate nohighlight">\(k\)</span> values.  The default
<span class="math notranslate nohighlight">\(k\)</span> spacing used in Larch (including as output from <a class="reference internal" href="xafs_autobk.html#autobk" title="autobk"><code class="xref py py-func docutils literal notranslate"><span class="pre">autobk()</span></code></a>)
is <span class="math notranslate nohighlight">\(\delta k\)</span> = 0.05 <span class="math notranslate nohighlight">\(\rm\AA^{-1}\)</span>.  Second, the array size for
<span class="math notranslate nohighlight">\(\chi(k)\)</span> used in the Fourier transform should be a power of 2. The
default used in Larch is <span class="math notranslate nohighlight">\(N_{\rm fft}\)</span> = 2048.   Together, these
allow <span class="math notranslate nohighlight">\(\chi(k)\)</span> data to 102.4 <span class="math notranslate nohighlight">\(\rm\AA^{-1}\)</span>.  Of course, real
data doesn’t extend that far, so the array to be transformed is
<em>zero-padded</em> to the end of the range.  Since the spacing <span class="math notranslate nohighlight">\(\delta R\)</span>
of the resulting discrete <span class="math notranslate nohighlight">\(\chi(R)\)</span> is given as
<span class="math notranslate nohighlight">\(\pi/{(N_{\rm fft} \delta k )}\)</span>, the extended range and zero-padding
will increase the density of points in <span class="math notranslate nohighlight">\(\chi(R)\)</span>, smoothly
interpolating the values.   For <span class="math notranslate nohighlight">\(N_{\rm fft}\)</span> = 2048 and
<span class="math notranslate nohighlight">\(\delta k\)</span> =  0.05 <span class="math notranslate nohighlight">\(\rm\AA^{-1}\)</span>, the <span class="math notranslate nohighlight">\(R\)</span> spacing is
approximately <span class="math notranslate nohighlight">\(\delta R\)</span> =  0.0307 <span class="math notranslate nohighlight">\(\rm\AA\)</span>.</p>
<p>For the discrete Fourier transforms with samples of <span class="math notranslate nohighlight">\(\chi(k)\)</span> at the
points <span class="math notranslate nohighlight">\(k_n = n \, \delta k\)</span>, and samples of <span class="math notranslate nohighlight">\(\chi(R)\)</span> at the
points <span class="math notranslate nohighlight">\(R_m = m \, \delta R\)</span>, the definitions become:</p>
<div class="math notranslate nohighlight">
\begin{eqnarray*}
\tilde\chi(R_m) &amp;=&amp; \frac{i \delta k}{\sqrt{\pi N_{\rm fft}}} \,
                    \sum_{n=1}^{N_{\rm fft}} \chi(k_n) \,
                    \Omega(k_n) \, k_n^w e^{2i\pi n m/N_{\rm fft}} \\
\tilde\chi(k_n) &amp;=&amp; \frac{2 i \delta R}{\sqrt{\pi N_{\rm fft}}} \,
                    \sum_{m=1}^{N_{\rm fft}} \tilde\chi(R_m) \,
                    \Omega(R_m) \, e^{-2i\pi n m/N_{\rm fft}} \\
\end{eqnarray*}</div><p>These normalizations preserve the symmetry properties of the Fourier
Transforms with conjugate variables <span class="math notranslate nohighlight">\(k\)</span> and <span class="math notranslate nohighlight">\(2R\)</span>.
Though the reverse transform converts the complex <span class="math notranslate nohighlight">\(\chi(R)\)</span> to the
complex <span class="math notranslate nohighlight">\(\chi(k)\)</span> on the same <span class="math notranslate nohighlight">\(k\)</span> spacing as the starting
data, we often refer to the filtered <span class="math notranslate nohighlight">\(\chi(k)\)</span> as <em>q</em> space.</p>
<p>A final complication in using Fourier transforms for XAFS is that the
measured <span class="math notranslate nohighlight">\(\mu(E)\)</span> and <span class="math notranslate nohighlight">\(\chi(k)\)</span> are a strictly real values,
while the Fourier transform inherently treats <span class="math notranslate nohighlight">\(\chi(k)\)</span> and
<span class="math notranslate nohighlight">\(\chi(R)\)</span> as complex values. This leads to an ambiguity about how to
construct the complex <span class="math notranslate nohighlight">\(\tilde\chi(k)\)</span>.  In many formal treatments,
XAFS is written as the imaginary part of a complex function.  This might
lead one to assume that constructing <span class="math notranslate nohighlight">\(\tilde\chi(k)\)</span> as <span class="math notranslate nohighlight">\(0 +
i\chi(k)\)</span> would be the natural choice.  For historical reasons, Larch uses
the opposite convention, constructing <span class="math notranslate nohighlight">\(\tilde\chi(k)\)</span> as
<span class="math notranslate nohighlight">\(\chi(k) + 0i\)</span>.   As we’ll see below, you can easily change this
convention.  The effect of this choice is minor unless one is
concerned about the differences of the real and imaginary parts of
<span class="math notranslate nohighlight">\(\chi(R)\)</span> or one is intending to filter and back-transform the
<span class="math notranslate nohighlight">\(\chi(R)\)</span> and compare the filtered and unfiltered data.</p>
</section>
<section id="forward-xafs-fourier-transforms-k-rightarrow-r">
<h2><span class="section-number">14.5.2. </span>Forward XAFS Fourier transforms (<span class="math notranslate nohighlight">\(k{\rightarrow}R\)</span>)<a class="headerlink" href="#forward-xafs-fourier-transforms-k-rightarrow-r" title="Link to this heading">¶</a></h2>
<p>The forward Fourier transform converts <span class="math notranslate nohighlight">\(\chi(k)\)</span> to <span class="math notranslate nohighlight">\(\chi(R)\)</span>
and is of primary importance for XAFS analysis.  In Larch, this is
encapsulated in the <a class="reference internal" href="#xftf" title="xftf"><code class="xref py py-func docutils literal notranslate"><span class="pre">xftf()</span></code></a> function.</p>
<dl class="py function">
<dt class="sig sig-object py" id="xftf">
<span class="sig-name descname"><span class="pre">xftf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chi=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">...</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xftf" title="Link to this definition">¶</a></dt>
<dd><p>perform a forward XAFS Fourier transform, from <span class="math notranslate nohighlight">\(\chi(k)\)</span> to
<span class="math notranslate nohighlight">\(\chi(R)\)</span>, using common XAFS conventions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k</strong> – 1-d array of photo-electron wavenumber in <span class="math notranslate nohighlight">\(\rm\AA^{-1}\)</span></p></li>
<li><p><strong>chi</strong> – 1-d array of <span class="math notranslate nohighlight">\(\chi\)</span></p></li>
<li><p><strong>group</strong> – output Group</p></li>
<li><p><strong>rmax_out</strong> – highest <em>R</em> for output data (10 <span class="math notranslate nohighlight">\(\rm\AA\)</span>)</p></li>
<li><p><strong>kweight</strong> – exponent for weighting spectra by <span class="math notranslate nohighlight">\(k^{\rm kweight}\)</span></p></li>
<li><p><strong>kmin</strong> – starting <em>k</em> for FT Window</p></li>
<li><p><strong>kmax</strong> – ending <em>k</em> for FT Window</p></li>
<li><p><strong>dk</strong> – tapering parameter for FT Window</p></li>
<li><p><strong>dk2</strong> – second tapering parameter for FT Window</p></li>
<li><p><strong>window</strong> – name of window type</p></li>
<li><p><strong>nfft</strong> – value to use for <span class="math notranslate nohighlight">\(N_{\rm fft}\)</span> (2048).</p></li>
<li><p><strong>kstep</strong> – value to use for <span class="math notranslate nohighlight">\(\delta{k}\)</span> (0.05).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">None</span></code> – outputs are written to supplied group.</p>
</dd>
</dl>
<p>Follows the First Argument Group convention, using group members named <code class="docutils literal notranslate"><span class="pre">k</span></code> and <code class="docutils literal notranslate"><span class="pre">chi</span></code>.
The following data is put into the output group:</p>
<blockquote>
<div><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>array name</p></th>
<th class="head"><p>meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>kwin</p></td>
<td><p>window <span class="math notranslate nohighlight">\(\Omega(k)\)</span> (length of input chi(k)).</p></td>
</tr>
<tr class="row-odd"><td><p>r</p></td>
<td><p>uniform array of <span class="math notranslate nohighlight">\(R\)</span>, out to <code class="docutils literal notranslate"><span class="pre">rmax_out</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p>chir</p></td>
<td><p>complex array of <span class="math notranslate nohighlight">\(\tilde\chi(R)\)</span>.</p></td>
</tr>
<tr class="row-odd"><td><p>chir_mag</p></td>
<td><p>magnitude of <span class="math notranslate nohighlight">\(\tilde\chi(R)\)</span>.</p></td>
</tr>
<tr class="row-even"><td><p>chir_pha</p></td>
<td><p>phase of <span class="math notranslate nohighlight">\(\tilde\chi(R)\)</span>.</p></td>
</tr>
<tr class="row-odd"><td><p>chir_re</p></td>
<td><p>real part of <span class="math notranslate nohighlight">\(\tilde\chi(R)\)</span>.</p></td>
</tr>
<tr class="row-even"><td><p>chir_im</p></td>
<td><p>imaginary part of <span class="math notranslate nohighlight">\(\tilde\chi(R)\)</span>.</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>It is expected that the input <code class="docutils literal notranslate"><span class="pre">k</span></code> be a uniformly spaced array of
values with spacing <code class="docutils literal notranslate"><span class="pre">kstep</span></code>, starting a 0.  If it is not, the <code class="docutils literal notranslate"><span class="pre">k</span></code>
and <code class="docutils literal notranslate"><span class="pre">chi</span></code> data will be linearly interpolated onto the proper grid.</p>
<p>The FT window parameters are explained in more detail in the discussion of
<a class="reference internal" href="#ftwindow" title="ftwindow"><code class="xref py py-func docutils literal notranslate"><span class="pre">ftwindow()</span></code></a>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xftf_fast">
<span class="sig-name descname"><span class="pre">xftf_fast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nfft</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2048</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kstep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xftf_fast" title="Link to this definition">¶</a></dt>
<dd><p>perform a forward XAFS Fourier transform, from <span class="math notranslate nohighlight">\(\chi(k)\)</span> to
<span class="math notranslate nohighlight">\(\chi(R)\)</span>, using common XAFS conventions.  This version demands
<code class="docutils literal notranslate"><span class="pre">chi</span></code> to include any weighting and windowing, and so to represent
<span class="math notranslate nohighlight">\(\chi(k)k^w\Omega(k)\)</span> on a uniform <span class="math notranslate nohighlight">\(k\)</span> grid. It returns
the complex array of <span class="math notranslate nohighlight">\(\chi(R)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chi</strong> – 1-d array of <span class="math notranslate nohighlight">\(\chi\)</span> to be transformed</p></li>
<li><p><strong>nfft</strong> – value to use for <span class="math notranslate nohighlight">\(N_{\rm fft}\)</span> (2048).</p></li>
<li><p><strong>kstep</strong> – value to use for <span class="math notranslate nohighlight">\(\delta{k}\)</span> (0.05).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>complex <span class="math notranslate nohighlight">\(\chi(R)\)</span>.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="reverse-xafs-fourier-transforms-r-rightarrow-q">
<h2><span class="section-number">14.5.3. </span>Reverse XAFS Fourier transforms (<span class="math notranslate nohighlight">\(R{\rightarrow}q\)</span>)<a class="headerlink" href="#reverse-xafs-fourier-transforms-r-rightarrow-q" title="Link to this heading">¶</a></h2>
<p>Reverse Fourier transforms convert <span class="math notranslate nohighlight">\(\chi(R)\)</span> back to filtered
<span class="math notranslate nohighlight">\(\chi(k)\)</span>.  We refer to the filtered <span class="math notranslate nohighlight">\(k\)</span> space as <span class="math notranslate nohighlight">\(q\)</span> to
emphasize the distinction between the two.  The filtered <span class="math notranslate nohighlight">\(\chi(q)\)</span> is
complex.  By convention, the real part of <span class="math notranslate nohighlight">\(\chi(q)\)</span> corresponds to
the explicitly real <span class="math notranslate nohighlight">\(\chi(k)\)</span>.</p>
<dl class="py function">
<dt class="sig sig-object py" id="xftr">
<span class="sig-name descname"><span class="pre">xftr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">...</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xftr" title="Link to this definition">¶</a></dt>
<dd><p>perform a reverse XAFS Fourier transform, from <span class="math notranslate nohighlight">\(\chi(R)\)</span> to
<span class="math notranslate nohighlight">\(\chi(q)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> – 1-d array of distance.</p></li>
<li><p><strong>chir</strong> – 1-d array of <span class="math notranslate nohighlight">\(\chi(R)\)</span></p></li>
<li><p><strong>group</strong> – output Group</p></li>
<li><p><strong>qmax_out</strong> – highest <em>k</em> for output data (30 <span class="math notranslate nohighlight">\(\rm\AA^{-1}\)</span>)</p></li>
<li><p><strong>rweight</strong> – exponent for weighting spectra by <span class="math notranslate nohighlight">\(r^{\rm rweight}\)</span> (0)</p></li>
<li><p><strong>rmin</strong> – starting <em>R</em> for FT Window</p></li>
<li><p><strong>rmax</strong> – ending <em>R</em> for FT Window</p></li>
<li><p><strong>dr</strong> – tapering parameter for FT Window</p></li>
<li><p><strong>dr2</strong> – second tapering parameter for FT Window</p></li>
<li><p><strong>window</strong> – name of window type</p></li>
<li><p><strong>nfft</strong> – value to use for <span class="math notranslate nohighlight">\(N_{\rm fft}\)</span> (2048).</p></li>
<li><p><strong>kstep</strong> – value to use for <span class="math notranslate nohighlight">\(\delta{k}\)</span> (0.05).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">None</span></code> – outputs are written to supplied group.</p>
</dd>
</dl>
<p>Follows the First Argument Group convention, using group members named <code class="docutils literal notranslate"><span class="pre">r</span></code> and <code class="docutils literal notranslate"><span class="pre">chir</span></code>.
The following data is put into the output group:</p>
<blockquote>
<div><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>array name</p></th>
<th class="head"><p>meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>rwin</p></td>
<td><p>window <span class="math notranslate nohighlight">\(\Omega(R)\)</span> (length of input chi(R)).</p></td>
</tr>
<tr class="row-odd"><td><p>q</p></td>
<td><p>uniform array of <span class="math notranslate nohighlight">\(k\)</span>, out to <code class="docutils literal notranslate"><span class="pre">qmax_out</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p>chiq</p></td>
<td><p>complex array of <span class="math notranslate nohighlight">\(\tilde\chi(k)\)</span>.</p></td>
</tr>
<tr class="row-odd"><td><p>chiq_mag</p></td>
<td><p>magnitude of <span class="math notranslate nohighlight">\(\tilde\chi(k)\)</span>.</p></td>
</tr>
<tr class="row-even"><td><p>chiq_pha</p></td>
<td><p>phase of <span class="math notranslate nohighlight">\(\tilde\chi(k)\)</span>.</p></td>
</tr>
<tr class="row-odd"><td><p>chiq_re</p></td>
<td><p>real part of <span class="math notranslate nohighlight">\(\tilde\chi(k)\)</span>.</p></td>
</tr>
<tr class="row-even"><td><p>chiq_im</p></td>
<td><p>imaginary part of <span class="math notranslate nohighlight">\(\tilde\chi(k)\)</span>.</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>In analogy with <a class="reference internal" href="#xftf" title="xftf"><code class="xref py py-func docutils literal notranslate"><span class="pre">xftf()</span></code></a>, it is expected that the input <code class="docutils literal notranslate"><span class="pre">r</span></code> be a
uniformly spaced array of values starting a 0.</p>
<p>The input <code class="docutils literal notranslate"><span class="pre">chir</span></code> array can be either the complex <span class="math notranslate nohighlight">\(\chi(R)\)</span> array
as output to <code class="docutils literal notranslate"><span class="pre">Group.chir</span></code> from <a class="reference internal" href="#xftf" title="xftf"><code class="xref py py-func docutils literal notranslate"><span class="pre">xftf()</span></code></a>, or one of the real or
imaginary parts of the <span class="math notranslate nohighlight">\(\chi(R)\)</span> as output to <code class="docutils literal notranslate"><span class="pre">Group.chir_re</span></code> or
<code class="docutils literal notranslate"><span class="pre">Group.chir_im</span></code>.</p>
<p>The FT window parameters are explained in more detail in the discussion of
<a class="reference internal" href="#ftwindow" title="ftwindow"><code class="xref py py-func docutils literal notranslate"><span class="pre">ftwindow()</span></code></a>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xftr_fast">
<span class="sig-name descname"><span class="pre">xftr_fast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nfft</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2048</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kstep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xftr_fast" title="Link to this definition">¶</a></dt>
<dd><p>perform a reverse XAFS Fourier transform, from <span class="math notranslate nohighlight">\(\chi(R)\)</span> to
<span class="math notranslate nohighlight">\(\chi(q)\)</span>, using common XAFS conventions.  This version demands
<code class="docutils literal notranslate"><span class="pre">chir</span></code> be  the complex <span class="math notranslate nohighlight">\(\chi(R)\)</span> as created from <a class="reference internal" href="#xftf" title="xftf"><code class="xref py py-func docutils literal notranslate"><span class="pre">xftf()</span></code></a>.
It returns the complex array of <span class="math notranslate nohighlight">\(\chi(q)\)</span> without putting any
values into a group.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chir</strong> – 1-d array of <span class="math notranslate nohighlight">\(\chi(R)\)</span> to be transformed</p></li>
<li><p><strong>nfft</strong> – value to use for <span class="math notranslate nohighlight">\(N_{\rm fft}\)</span> (2048).</p></li>
<li><p><strong>kstep</strong> – value to use for <span class="math notranslate nohighlight">\(\delta{k}\)</span> (0.05).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>complex <span class="math notranslate nohighlight">\(\chi(q)\)</span>.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="ftwindow-generating-fourier-transform-windows">
<h2><span class="section-number">14.5.4. </span><a class="reference internal" href="#ftwindow" title="ftwindow"><code class="xref py py-func docutils literal notranslate"><span class="pre">ftwindow()</span></code></a>: Generating Fourier transform windows<a class="headerlink" href="#ftwindow-generating-fourier-transform-windows" title="Link to this heading">¶</a></h2>
<p>As mentioned above, a Fourier transform window will smooth the resulting
Fourier transformed spectrum, removing ripple and ringing in it that would
result from a sudden truncation data at the end of it range.  There is an
extensive literature on such windows, and a lot of choices and parameters
available for constructing windows.  A sampling of windows is shown below.</p>
<dl class="py function">
<dt class="sig sig-object py" id="ftwindow">
<span class="sig-name descname"><span class="pre">ftwindow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmin=0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmax=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dk=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">...</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ftwindow" title="Link to this definition">¶</a></dt>
<dd><p>create a Fourier transform window array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – 1-d array array to build window on.</p></li>
<li><p><strong>xmin</strong> – starting <em>x</em> for FT Window</p></li>
<li><p><strong>xmax</strong> – ending <em>x</em> for FT Window</p></li>
<li><p><strong>dx</strong> – tapering parameter for FT Window</p></li>
<li><p><strong>dx2</strong> – second tapering parameter for FT Window (=dx)</p></li>
<li><p><strong>window</strong> – name of window type</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>1-d window array.</p>
</dd>
</dl>
<p>Note that if <code class="docutils literal notranslate"><span class="pre">dx</span></code> is specified but <code class="docutils literal notranslate"><span class="pre">dx2</span></code> is not, <code class="docutils literal notranslate"><span class="pre">dx2</span></code> will
generally take the same value as <code class="docutils literal notranslate"><span class="pre">dx</span></code>.</p>
<p>The window type must be one of those listed in the <a class="reference internal" href="#xafs-ftwin-table"><span class="std std-ref">Table of
Fourier Transform Window Types</span></a>.</p>
</dd></dl>

<blockquote id="xafs-ftwin-table">
<span id="index-0"></span><div><p>Table of Fourier Transform Window Types.</p>
<blockquote>
<div><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>window name</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>hanning</p></td>
<td><p>cosine-squared taper</p></td>
</tr>
<tr class="row-odd"><td><p>parzen</p></td>
<td><p>linear taper</p></td>
</tr>
<tr class="row-even"><td><p>welch</p></td>
<td><p>quadratic taper</p></td>
</tr>
<tr class="row-odd"><td><p>gaussian</p></td>
<td><p>Gaussian (normal) function window</p></td>
</tr>
<tr class="row-even"><td><p>sine</p></td>
<td><p>sine function window</p></td>
</tr>
<tr class="row-odd"><td><p>kaiser</p></td>
<td><p>Kaiser-Bessel function-derived window</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</div></blockquote>
<p>In general, the window arrays have a value that gradually increases from 0
up to 1 at the low-k end, may stay with a value 1 over some central
portion, and then tapers down to 0 at the high-k end.  The meaning of the
<code class="docutils literal notranslate"><span class="pre">dx</span></code> and <code class="docutils literal notranslate"><span class="pre">dx2</span></code>, and even <code class="docutils literal notranslate"><span class="pre">xmin</span></code>, and <code class="docutils literal notranslate"><span class="pre">xmax</span></code> varies a bit for the
different window types.  The Hanning, Parzen, and Welch windows share a
convention that the windows taper up from 0 to 1 between <code class="docutils literal notranslate"><span class="pre">xmin-dx/2</span></code> and
<code class="docutils literal notranslate"><span class="pre">xmin+dx/2</span></code>, and then taper down from 1 to 0 between <code class="docutils literal notranslate"><span class="pre">xmax-dx2/2</span></code> and
<code class="docutils literal notranslate"><span class="pre">xmax+dx2/2</span></code>.</p>
<p>The conventions for the Kaiser, Gaussian, and Sine window types is a bit
more complicated, and is best given explicitly.  In the formulas below,
<code class="docutils literal notranslate"><span class="pre">dx</span></code> written as <span class="math notranslate nohighlight">\(dx\)</span> and <code class="docutils literal notranslate"><span class="pre">dx2</span></code> as <span class="math notranslate nohighlight">\(dx_2\)</span>.  We
define <span class="math notranslate nohighlight">\(x_i = x_{\rm min} - dx/2\)</span>, <span class="math notranslate nohighlight">\(x_f = x_{\rm max} +
dx_2/2\)</span>, and <span class="math notranslate nohighlight">\(x_0 = (x_f + x_i)/2\)</span>, as the beginning, end, and
center of the widows.  For the Gaussian window, the form is:</p>
<div class="math notranslate nohighlight">
\[\Omega(x) = \exp{\bigl[ -\frac{(x - x_0)^2}{2{dx}^2}\bigr]}\]</div>
<p>The form for the Sine window is</p>
<div class="math notranslate nohighlight">
\[\Omega(x) = \sin{\bigl[ \frac{ \pi(x_f - x)}{x_f - x_i}\bigr]}\]</div>
<p>between <span class="math notranslate nohighlight">\(x_i\)</span>  and  <span class="math notranslate nohighlight">\(x_f\)</span>, and 0 outside this range.
The Kaiser-Bessel window is slightly more complicated:</p>
<div class="math notranslate nohighlight">
\begin{eqnarray*}
   a       &amp;=&amp; \sqrt{\max{\bigl[0, 1 - \frac{4(x-x_0)^2}{(x_f-x_i)^2} \bigr] }} \\
  \Omega(x) &amp;=&amp; \frac{i_0(a dx) - 1}{i_0(dx) - 1} \\
\end{eqnarray*}</div><p>where <span class="math notranslate nohighlight">\(i_0\)</span> is the modified Bessel function of order 0.</p>
</section>
<section id="catalog-of-fourier-transform-window">
<h2><span class="section-number">14.5.5. </span>Catalog of Fourier transform window<a class="headerlink" href="#catalog-of-fourier-transform-window" title="Link to this heading">¶</a></h2>
<p>Here, we give a series of example windows, to illustrate the different
window types and the effect of the various parameters.  The meanings of
<code class="docutils literal notranslate"><span class="pre">xmin</span></code>, <code class="docutils literal notranslate"><span class="pre">xmax</span></code>, <code class="docutils literal notranslate"><span class="pre">dx</span></code> and <code class="docutils literal notranslate"><span class="pre">dx2</span></code> are identical for the Hanning, Parzen and
Welch windows, and illustrated in the two following figures.</p>
<div class="figure compound align-center" id="fig-xafsft1">
<figure class="align-default" id="fig-xafsft1a">
<a class="reference external image-reference" href="_images/ftwin_example1.png"><img alt="_images/ftwin_example1.png" src="_images/ftwin_example1.png" style="width: 100%;" />
</a>
</figure>
<figure class="align-default" id="fig-xafsft1b">
<a class="reference external image-reference" href="_images/ftwin_example2.png"><img alt="_images/ftwin_example2.png" src="_images/ftwin_example2.png" style="width: 100%;" />
</a>
</figure>
<p><span class="caption-text">Fourier Transform window examples and illustration of parameter meaning
for the Hanning, Parzen, and Welch windows.  Note that
<span class="math notranslate nohighlight">\(\Omega(x=x_{\rm min}) = \Omega(x=x_{\rm max}) = 0.5\)</span>, and that
the meaning of <code class="docutils literal notranslate"><span class="pre">dx</span></code> is to control the taper over which the window
changes from 0 to 1.  Here, <code class="docutils literal notranslate"><span class="pre">xmin=5</span></code> and <code class="docutils literal notranslate"><span class="pre">xmax=15</span></code>.</span></p>
</div><p id="fig-xafsft1">Some more window functions:</p>
<div class="figure compound align-center" id="fig-xafsft2">
<figure class="align-default" id="fig-xafsft2a">
<a class="reference external image-reference" href="_images/ftwin_example3.png"><img alt="_images/ftwin_example3.png" src="_images/ftwin_example3.png" style="width: 100%;" />
</a>
</figure>
<figure class="align-default" id="fig-xafsft2b">
<a class="reference external image-reference" href="_images/ftwin_example4.png"><img alt="_images/ftwin_example4.png" src="_images/ftwin_example4.png" style="width: 100%;" />
</a>
</figure>
<p><span class="caption-text">Fourier Transform window examples and illustration of parameter
meaning.  On the left, a comparison of Welch, Parzen, and Hanning with
the same parameters is shown.  On the right, the effect of <code class="docutils literal notranslate"><span class="pre">dx2</span></code> is
shown as a different amount of taper on the high- and low-<code class="docutils literal notranslate"><span class="pre">x</span></code> end of
the window.  As before, <code class="docutils literal notranslate"><span class="pre">xmin=5</span></code> and <code class="docutils literal notranslate"><span class="pre">xmax=15</span></code>.</span></p>
</div><p id="fig-xafsft2">The Gaussian, Sine, and Kaiser-Bessel windows are illustrated next. These
go to 1 at the average of <code class="docutils literal notranslate"><span class="pre">xmin</span></code> and <code class="docutils literal notranslate"><span class="pre">xmax</span></code>, but do not stay at 1 over
a central portion of the window – they taper continuously.  The Gaussian
window is a simple Gaussian function, and is not truncated according to
<code class="docutils literal notranslate"><span class="pre">xmin</span></code> and <code class="docutils literal notranslate"><span class="pre">xmax</span></code>, and the <code class="docutils literal notranslate"><span class="pre">dx</span></code> parameter sets the width.  The Sine
and Kaiser-Bessel windows both go to zero at  <code class="docutils literal notranslate"><span class="pre">xmin-dx/2</span></code> and <code class="docutils literal notranslate"><span class="pre">xmax</span> <span class="pre">+</span>
<span class="pre">dx/2</span></code>.  For very large values of <code class="docutils literal notranslate"><span class="pre">dx</span></code>, the Kaiser-Bessel window
approaches a nearly Gaussian lineshape.</p>
<div class="figure compound align-center" id="fig-xafsft3">
<figure class="align-default" id="fig-xafsft3a">
<a class="reference external image-reference" href="_images/ftwin_example5.png"><img alt="_images/ftwin_example5.png" src="_images/ftwin_example5.png" style="width: 100%;" />
</a>
</figure>
<figure class="align-default" id="fig-xafsft3b">
<a class="reference external image-reference" href="_images/ftwin_example6.png"><img alt="_images/ftwin_example6.png" src="_images/ftwin_example6.png" style="width: 100%;" />
</a>
</figure>
<p><span class="caption-text">Fourier Transform windows. On the left, a comparison of Kaiser-Bessel,
Sine, and Gaussian windows with the same parameters is shown.  On the
right, the effect of <code class="docutils literal notranslate"><span class="pre">dx</span></code> is shown for the Kaiser-Bessel window, and
a closer comparison to a Gaussian window is made.</span></p>
</div></section>
<section id="examples-forward-xafs-fourier-transforms">
<span id="fig-xafsft3"></span><h2><span class="section-number">14.5.6. </span>Examples: Forward XAFS Fourier transforms<a class="headerlink" href="#examples-forward-xafs-fourier-transforms" title="Link to this heading">¶</a></h2>
<p>Now we show some example Fourier transforms, illustrating the real and
imaginary parts of the <span class="math notranslate nohighlight">\(\chi(R)\)</span> as well as the magnitude, the effect
of different windows types, and Fourier filtering to <span class="math notranslate nohighlight">\(\chi(q)\)</span>.  We
use a single XAFS dataset from FeO for all these examples, with a
well-separated first and second shell.  The full scripts to generate the
figures shown here are included in the <em>examples/xafs/</em> folder.</p>
<p>We start with a comparison of a small value of <code class="docutils literal notranslate"><span class="pre">dk</span></code> and a larger value.
A script that runs <a class="reference internal" href="#xftf" title="xftf"><code class="xref py py-func docutils literal notranslate"><span class="pre">xftf()</span></code></a>, changing on <code class="docutils literal notranslate"><span class="pre">dk</span></code> would look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xftf</span><span class="p">(</span><span class="n">dat1</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">dat1</span><span class="o">.</span><span class="n">chi</span><span class="p">,</span> <span class="n">kmin</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">kmax</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">dk</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;hanning&#39;</span><span class="p">,</span>
     <span class="n">kweight</span><span class="o">=</span><span class="n">kweight</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">dat1</span><span class="p">)</span>

<span class="n">dat2</span> <span class="o">=</span> <span class="n">group</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">dat1</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">chi</span><span class="o">=</span><span class="n">dat1</span><span class="o">.</span><span class="n">chi</span><span class="p">)</span> <span class="c1"># make a copy of the group</span>
<span class="n">xftf</span><span class="p">(</span><span class="n">dat2</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">dat2</span><span class="o">.</span><span class="n">chi</span><span class="p">,</span> <span class="n">kmin</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">kmax</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">dk</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;hanning&#39;</span><span class="p">,</span>
     <span class="n">kweight</span><span class="o">=</span><span class="n">kweight</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">dat2</span><span class="p">)</span>
</pre></div>
</div>
<p>would result in the following results:</p>
<div class="figure compound align-center" id="fig-xafsft4">
<figure class="align-default" id="fig-xafsft4a">
<a class="reference external image-reference" href="_images/xft_example1.png"><img alt="_images/xft_example1.png" src="_images/xft_example1.png" style="width: 100%;" />
</a>
</figure>
<figure class="align-default" id="fig-xafsft4b">
<a class="reference external image-reference" href="_images/xft_example2.png"><img alt="_images/xft_example2.png" src="_images/xft_example2.png" style="width: 100%;" />
</a>
</figure>
<p><span class="caption-text">Comparison of the effect of different values of <code class="docutils literal notranslate"><span class="pre">dk</span></code> on real XAFS
Fourier transforms.  Increasing <code class="docutils literal notranslate"><span class="pre">dk</span></code> reduces peak heights and tends
to broaden peaks, but the effects are rather small.</span></p>
</div><p id="fig-xafsft4">A script that runs <a class="reference internal" href="#xftf" title="xftf"><code class="xref py py-func docutils literal notranslate"><span class="pre">xftf()</span></code></a> with consistent parameters, but different
window types:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xftf</span><span class="p">(</span><span class="n">dat1</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">dat1</span><span class="o">.</span><span class="n">chi</span><span class="p">,</span> <span class="n">kmin</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">kmax</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">dk</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;hanning&#39;</span><span class="p">,</span>
     <span class="n">kweight</span><span class="o">=</span><span class="n">kweight</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">dat1</span><span class="p">)</span>

<span class="n">dat2</span> <span class="o">=</span> <span class="n">group</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">dat1</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">chi</span><span class="o">=</span><span class="n">dat1</span><span class="o">.</span><span class="n">chi</span><span class="p">)</span> <span class="c1"># make a copy of the group</span>
<span class="n">xftf</span><span class="p">(</span><span class="n">dat2</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">dat2</span><span class="o">.</span><span class="n">chi</span><span class="p">,</span> <span class="n">kmin</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">kmax</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">dk</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;parzen&#39;</span><span class="p">,</span>
     <span class="n">kweight</span><span class="o">=</span><span class="n">kweight</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">dat2</span><span class="p">)</span>

<span class="n">dat3</span> <span class="o">=</span> <span class="n">group</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">dat1</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">chi</span><span class="o">=</span><span class="n">dat1</span><span class="o">.</span><span class="n">chi</span><span class="p">)</span> <span class="c1">#</span>
<span class="n">xftf</span><span class="p">(</span><span class="n">dat3</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">dat3</span><span class="o">.</span><span class="n">chi</span><span class="p">,</span> <span class="n">kmin</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">kmax</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">dk</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;welch&#39;</span><span class="p">,</span>
     <span class="n">kweight</span><span class="o">=</span><span class="n">kweight</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">dat3</span><span class="p">)</span>

<span class="n">dat4</span> <span class="o">=</span> <span class="n">group</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">dat1</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">chi</span><span class="o">=</span><span class="n">dat1</span><span class="o">.</span><span class="n">chi</span><span class="p">)</span> <span class="c1">#</span>
<span class="n">xftf</span><span class="p">(</span><span class="n">dat4</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">dat4</span><span class="o">.</span><span class="n">chi</span><span class="p">,</span> <span class="n">kmin</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">kmax</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">dk</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;kaiser&#39;</span><span class="p">,</span>
     <span class="n">kweight</span><span class="o">=</span><span class="n">kweight</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">dat4</span><span class="p">)</span>

<span class="n">dat5</span> <span class="o">=</span> <span class="n">group</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">dat1</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">chi</span><span class="o">=</span><span class="n">dat1</span><span class="o">.</span><span class="n">chi</span><span class="p">)</span> <span class="c1">#</span>
<span class="n">xftf</span><span class="p">(</span><span class="n">dat5</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">dat5</span><span class="o">.</span><span class="n">chi</span><span class="p">,</span> <span class="n">kmin</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">kmax</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">dk</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;gaussian&#39;</span><span class="p">,</span>
     <span class="n">kweight</span><span class="o">=</span><span class="n">kweight</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">dat5</span><span class="p">)</span>
</pre></div>
</div>
<p>would result in the following results:</p>
<div class="figure compound align-center" id="fig-xafsft-windows">
<figure class="align-default" id="fig-xafsft-winsa">
<a class="reference external image-reference" href="_images/xft_example3.png"><img alt="_images/xft_example3.png" src="_images/xft_example3.png" style="width: 100%;" />
</a>
</figure>
<figure class="align-default" id="fig-xafsft-winsb">
<a class="reference external image-reference" href="_images/xft_example4.png"><img alt="_images/xft_example4.png" src="_images/xft_example4.png" style="width: 100%;" />
</a>
</figure>
<p><span class="caption-text">Comparison of the effect of different window types on real XAFS Fourier
transforms.</span></p>
</div><p id="fig-xafsft-windows">We now turn our attention to the different components of the Fourier
transform.  As above, it is most common to plot the magnitude of the
Fourier transform.  But, as the transformed <span class="math notranslate nohighlight">\(\chi(R)\)</span> is complex, it
can be instructive to plot the real and imaginary components, as shown
below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">newplot</span><span class="p">(</span><span class="n">dat1</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">dat1</span><span class="o">.</span><span class="n">chir_mag</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;chir_mag&#39;</span><span class="p">,</span>
        <span class="n">show_legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">legend_loc</span><span class="o">=</span><span class="s1">&#39;ur&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
        <span class="n">xlabel</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$R \rm\, (\AA)$&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\chi(R)\rm\,(\AA^{-3})$&#39;</span> <span class="p">)</span>

<span class="n">plot</span><span class="p">(</span><span class="n">dat1</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">dat1</span><span class="o">.</span><span class="n">chir_re</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;chir_re&#39;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">dat1</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">dat1</span><span class="o">.</span><span class="n">chir_im</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;chir_im&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>which results in</p>
<figure class="align-center" id="id1">
<span id="fig-xafsft-ri"></span><a class="reference external image-reference" href="_images/xft_example5.png"><img alt="_images/xft_example5.png" src="_images/xft_example5.png" style="width: 65%;" />
</a>
<figcaption>
<p><span class="caption-number">Figure 14.5.6.1 </span><span class="caption-text">The real and imaginary components of the XAFS Fourier transform.</span><a class="headerlink" href="#id1" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>In fact, in the analysis discussed with <a class="reference internal" href="xafs_feffit.html#id0" title="feffit"><code class="xref py py-func docutils literal notranslate"><span class="pre">feffit()</span></code></a>, the real and
imaginary components are used, not simply the magnitude.</p>
</section>
<section id="examples-reverse-xafs-fourier-transforms-fourier-filtering">
<h2><span class="section-number">14.5.7. </span>Examples: Reverse XAFS Fourier transforms, Fourier Filtering<a class="headerlink" href="#examples-reverse-xafs-fourier-transforms-fourier-filtering" title="Link to this heading">¶</a></h2>
<p>A reverse Fourier transform will convert data from <span class="math notranslate nohighlight">\(\chi(R)\)</span> to
<span class="math notranslate nohighlight">\(\chi(q)\)</span>.  This allows a limited range of frequencies (distances) to
be isolated and turned back into a <span class="math notranslate nohighlight">\(\chi(k)\)</span> spectrum.  Here, we show
two different <span class="math notranslate nohighlight">\(R\)</span> windows to filter either just the first shell of
the spectra, or the first two shells, and compare the resulting filtered
<span class="math notranslate nohighlight">\(\chi(q)\)</span>.</p>
<div class="figure compound align-center" id="fig-xafsft-filter">
<figure class="align-default" id="fig-xafsft-filtera">
<a class="reference external image-reference" href="_images/xft_example6.png"><img alt="_images/xft_example6.png" src="_images/xft_example6.png" style="width: 100%;" />
</a>
</figure>
<figure class="align-default" id="fig-xafsft-filterb">
<a class="reference external image-reference" href="_images/xft_example7.png"><img alt="_images/xft_example7.png" src="_images/xft_example7.png" style="width: 100%;" />
</a>
</figure>
<p><span class="caption-text">Reverse XAFS Fourier transform, or Fourier filtering.  Here, one can
see the effect of different window sizes on the Fourier filtered
spectrum.  Including the first two peaks or shells reproduces most of
the original spectrum, with only high-frequency components removed.</span></p>
</div><p id="fig-xafsft-filter">Note that it is <code class="docutils literal notranslate"><span class="pre">chiq_re</span></code> that is compared to the k-weighted <code class="docutils literal notranslate"><span class="pre">chi</span></code>
array.</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="xafs_wavelets.html" title="14.6. XAFS: Wavelet Transforms for XAFS"
             >next</a> |</li>
        <li class="right" >
          <a href="xafs_autobk.html" title="14.4. XAFS: Post-edge Background Subtraction"
             >previous</a> |</li>
   <li>[<a href="index.html"> Larch</a>|</li>
   <li><a href="getting_started.html"> Getting Started</a>|</li>
   <li><a href="xafs.html">XAFS Analysis</a>|</li>
   <li><a href="xray.html">X-ray Databases</a>|</li>
   <li><a href="xrf.html">XRF Analysis</a>|</li>

          <li class="nav-item nav-item-1"><a href="xafs.html" ><span class="section-number">14. </span>XAFS Analysis</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">14.5. </span>XAFS: Fourier Transforms for XAFS</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright Matthew Newville, The University of Chicago, 2022.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    </div>
  </body>
</html>