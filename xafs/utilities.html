

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>12.1. XAFS Functions: Overview and Naming Conventions &#8212; xraylarch 0.9.47 documentation</title>
    <link rel="stylesheet" href="../_static/larchdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="12.2. XAFS: Pre-edge Subtraction, Normalization, and data treatment" href="preedge.html" />
    <link rel="prev" title="12. XAFS Analysis" href="index.html" />

<script async src="https://badge.dimensions.ai/badge.js" charset="utf-8"></script>

<script type="text/x-mathjax-config">
   MathJax.Hub.Config({ "TeX": {Macros: {AA : "{\\unicode{x212B}}"}}, "HTML-CSS": {scale: 90}});
</script>


  </head><body>
<div style=" color: #c5daba;  text-align: left; height:65px; padding: 0px">
<table border=0>
  <tr>
    <td width=20%>
	<a href="../index.html">
	 <img src="../_static/larchcones.png" height=50px alt="larchcones"/></a>
    </td>
    <td width=75% padding=0>
      <font size=+2>
	<a href="../index.html" style="color:#772211">
	  Larch: Data Analysis Tools for X-ray Spectroscopy
	</a>
      </font>
    </td>
   </tr></table>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="preedge.html" title="12.2. XAFS: Pre-edge Subtraction, Normalization, and data treatment"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="12. XAFS Analysis"
             accesskey="P">previous</a> |</li>
   <li>[<a href="../index.html"> Larch</a>|</li>
   <li><a href="../getting_started.html"> Getting Started</a>|</li>
   <li><a href="index.html">XAFS Analysis</a>|</li>
   <li><a href="../xray/index.html">X-ray Databases</a>|</li>
   <li><a href="../xrf/index.html">XRF Analysis</a>|</li>
   <li><a href="../fitting/index.html">Curve Fitting</a>|</li>

          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U"><span class="section-number">12. </span>XAFS Analysis</a> &#187;</li> 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">12.1. XAFS Functions: Overview and Naming Conventions</a><ul>
<li><a class="reference internal" href="#naming-conventions-for-xafs-arrays">12.1.1. Naming conventions for XAFS arrays</a><ul>
<li><a class="reference internal" href="#group-argument-and-sys-xafsgroup">12.1.1.1. <cite>group</cite> argument and <code class="docutils literal notranslate"><span class="pre">_sys.xafsGroup</span></code></a></li>
<li><a class="reference internal" href="#first-argument-group-convention">12.1.1.2. First Argument Group convention</a></li>
</ul>
</li>
<li><a class="reference internal" href="#plotting-macros-for-xafs">12.1.2. Plotting Macros for XAFS</a><ul>
<li><a class="reference internal" href="#plot-mu">12.1.2.1. <code class="xref py py-func docutils literal notranslate"><span class="pre">plot_mu()</span></code></a></li>
<li><a class="reference internal" href="#plot-bkg">12.1.2.2. <code class="xref py py-func docutils literal notranslate"><span class="pre">plot_bkg()</span></code></a></li>
<li><a class="reference internal" href="#plot-chik">12.1.2.3. <code class="xref py py-func docutils literal notranslate"><span class="pre">plot_chik()</span></code></a></li>
<li><a class="reference internal" href="#plot-chir">12.1.2.4. <code class="xref py py-func docutils literal notranslate"><span class="pre">plot_chir()</span></code></a></li>
<li><a class="reference internal" href="#plot-chifit">12.1.2.5. <code class="xref py py-func docutils literal notranslate"><span class="pre">plot_chifit()</span></code></a></li>
<li><a class="reference internal" href="#plot-path-k">12.1.2.6. <code class="xref py py-func docutils literal notranslate"><span class="pre">plot_path_k()</span></code></a></li>
<li><a class="reference internal" href="#plot-path-r">12.1.2.7. <code class="xref py py-func docutils literal notranslate"><span class="pre">plot_path_r()</span></code></a></li>
<li><a class="reference internal" href="#plot-paths-k">12.1.2.8. <code class="xref py py-func docutils literal notranslate"><span class="pre">plot_paths_k()</span></code></a></li>
<li><a class="reference internal" href="#plot-paths-r">12.1.2.9. <code class="xref py py-func docutils literal notranslate"><span class="pre">plot_paths_r()</span></code></a></li>
<li><a class="reference internal" href="#plot-prepeaks-baseline">12.1.2.10. <code class="xref py py-func docutils literal notranslate"><span class="pre">plot_prepeaks_baseline()</span></code></a></li>
<li><a class="reference internal" href="#plot-prepeaks-fit">12.1.2.11. <code class="xref py py-func docutils literal notranslate"><span class="pre">plot_prepeaks_fit()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#utility-functions-for-xafs">12.1.3. Utility Functions for XAFS</a><ul>
<li><a class="reference internal" href="#ktoe-and-etok">12.1.3.1. <code class="xref py py-func docutils literal notranslate"><span class="pre">ktoe()</span></code> and <code class="xref py py-func docutils literal notranslate"><span class="pre">etok()</span></code></a></li>
<li><a class="reference internal" href="#estimate-noise">12.1.3.2. <code class="xref py py-func docutils literal notranslate"><span class="pre">estimate_noise()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter"><span class="section-number">12. </span>XAFS Analysis</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="preedge.html"
                        title="next chapter"><span class="section-number">12.2. </span>XAFS: Pre-edge Subtraction, Normalization, and data treatment</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/xafs/utilities.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="xafs-functions-overview-and-naming-conventions">
<h1><span class="section-number">12.1. </span>XAFS Functions: Overview and Naming Conventions<a class="headerlink" href="#xafs-functions-overview-and-naming-conventions" title="Permalink to this headline">¶</a></h1>
<p>As with most Larch functions, each of the XAFS functions is designed to be
able to act on arbitrary arrays of data to allow maximum flexibility in
processing data.  In addition, many of the Larch XAFS functions can write
out several output values, including both scalaras and arrays.  While
flexible, this could get rather cumbersome, and mean that you would
generally have to keep track of a large set of related arrays.</p>
<div class="section" id="naming-conventions-for-xafs-arrays">
<h2><span class="section-number">12.1.1. </span>Naming conventions for XAFS arrays<a class="headerlink" href="#naming-conventions-for-xafs-arrays" title="Permalink to this headline">¶</a></h2>
<p>In Larch, it is most natural to put related data into a Group.  This is
often natural as data read in from a file is already held in a Group.  If a
set of XAFS data is held within a Group, then the Group members named
<cite>energy</cite> and <cite>k</cite> and <cite>chi</cite> can be assumed to have the same standard meaning
for all groups of XAFS Data.  To make this most common usage easy, all of
the XAFS functions follow a couple conventions for working more easily with
Groups tht can work on arbitrary arrays of data, but assume that they will
write output values to a Group.  In addition, the XAFS functions can
usually just be given a Group that follows the expected XAFS naming
convention.  This is not rigidly enforced, and is not exclusive (that is,
you can add data with other names), but following the expected naming
conventions will make processing XAFS data much easier.</p>
<p>The naming convention define a set of <strong>expected names and meaning</strong> for
data arrays and scalars within a Group.  This is summarized in the
<a class="reference internal" href="#xafsnames-table"><span class="std std-ref">Table of Conventional Names for an XAFS Group</span></a> below.</p>
<p id="xafsnames-table"><strong>Table of Conventional Names for an XAFS Group</strong> These are the standard names for arrays and
scalars for various data associated with XAFS, including FEFF calculations.  Given are the name,
the physical quantity described, and the name of function that will generate this value.</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 17%" />
<col style="width: 9%" />
<col style="width: 33%" />
<col style="width: 41%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>name</p></th>
<th class="head"><p>type</p></th>
<th class="head"><p>meaning</p></th>
<th class="head"><p>created by</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>energy</p></td>
<td><p>array</p></td>
<td><p><span class="math notranslate nohighlight">\(E\)</span> in eV</p></td>
<td><p>original data</p></td>
</tr>
<tr class="row-odd"><td><p>mu</p></td>
<td><p>array</p></td>
<td><p><span class="math notranslate nohighlight">\(\mu\)</span></p></td>
<td><p>original data</p></td>
</tr>
<tr class="row-even"><td><p>e0</p></td>
<td><p>scalar</p></td>
<td><p><span class="math notranslate nohighlight">\(E_0\)</span></p></td>
<td><p><a class="reference internal" href="preedge.html#pre_edge" title="pre_edge"><code class="xref py py-func docutils literal notranslate"><span class="pre">pre_edge()</span></code></a>, <code class="xref py py-func docutils literal notranslate"><span class="pre">find_e0()</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>edge_step</p></td>
<td><p>scalar</p></td>
<td><p><span class="math notranslate nohighlight">\(\Delta \mu\)</span></p></td>
<td><p><a class="reference internal" href="preedge.html#pre_edge" title="pre_edge"><code class="xref py py-func docutils literal notranslate"><span class="pre">pre_edge()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>dmude</p></td>
<td><p>array</p></td>
<td><p><span class="math notranslate nohighlight">\(d\mu/dE\)</span></p></td>
<td><p><a class="reference internal" href="preedge.html#pre_edge" title="pre_edge"><code class="xref py py-func docutils literal notranslate"><span class="pre">pre_edge()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>norm</p></td>
<td><p>array</p></td>
<td><p>normalized <span class="math notranslate nohighlight">\(\mu\)</span></p></td>
<td><p><a class="reference internal" href="preedge.html#pre_edge" title="pre_edge"><code class="xref py py-func docutils literal notranslate"><span class="pre">pre_edge()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>flat</p></td>
<td><p>array</p></td>
<td><p>flattened <span class="math notranslate nohighlight">\(\mu\)</span></p></td>
<td><p><a class="reference internal" href="preedge.html#pre_edge" title="pre_edge"><code class="xref py py-func docutils literal notranslate"><span class="pre">pre_edge()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>pre_edge</p></td>
<td><p>array</p></td>
<td><p>pre-edge curve</p></td>
<td><p><a class="reference internal" href="preedge.html#pre_edge" title="pre_edge"><code class="xref py py-func docutils literal notranslate"><span class="pre">pre_edge()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>post_edge</p></td>
<td><p>array</p></td>
<td><p>normalization curve</p></td>
<td><p><a class="reference internal" href="preedge.html#pre_edge" title="pre_edge"><code class="xref py py-func docutils literal notranslate"><span class="pre">pre_edge()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>bkg</p></td>
<td><p>array</p></td>
<td><p><span class="math notranslate nohighlight">\(\mu_0(E)\)</span></p></td>
<td><p><a class="reference internal" href="autobk.html#autobk" title="autobk"><code class="xref py py-func docutils literal notranslate"><span class="pre">autobk()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>chie</p></td>
<td><p>array</p></td>
<td><p><span class="math notranslate nohighlight">\(\chi(E)\)</span></p></td>
<td><p><a class="reference internal" href="autobk.html#autobk" title="autobk"><code class="xref py py-func docutils literal notranslate"><span class="pre">autobk()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>k</p></td>
<td><p>array</p></td>
<td><p><span class="math notranslate nohighlight">\(k\)</span></p></td>
<td><p><a class="reference internal" href="autobk.html#autobk" title="autobk"><code class="xref py py-func docutils literal notranslate"><span class="pre">autobk()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>chi</p></td>
<td><p>array</p></td>
<td><p><span class="math notranslate nohighlight">\(\chi(k)\)</span></p></td>
<td><p><a class="reference internal" href="autobk.html#autobk" title="autobk"><code class="xref py py-func docutils literal notranslate"><span class="pre">autobk()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>kwin</p></td>
<td><p>array</p></td>
<td><p><span class="math notranslate nohighlight">\(\Omega(k)\)</span></p></td>
<td><p><a class="reference internal" href="xafsft.html#xftf" title="xftf"><code class="xref py py-func docutils literal notranslate"><span class="pre">xftf()</span></code></a>, <a class="reference internal" href="xafsft.html#ftwindow" title="ftwindow"><code class="xref py py-func docutils literal notranslate"><span class="pre">ftwindow()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>r</p></td>
<td><p>array</p></td>
<td><p><span class="math notranslate nohighlight">\(R\)</span></p></td>
<td><p><a class="reference internal" href="xafsft.html#xftf" title="xftf"><code class="xref py py-func docutils literal notranslate"><span class="pre">xftf()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>chir</p></td>
<td><p>array</p></td>
<td><p><span class="math notranslate nohighlight">\(\chi(R)\)</span> (complex)</p></td>
<td><p><a class="reference internal" href="xafsft.html#xftf" title="xftf"><code class="xref py py-func docutils literal notranslate"><span class="pre">xftf()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>chir_mag</p></td>
<td><p>array</p></td>
<td><p><span class="math notranslate nohighlight">\(|\chi(R)|\)</span></p></td>
<td><p><a class="reference internal" href="xafsft.html#xftf" title="xftf"><code class="xref py py-func docutils literal notranslate"><span class="pre">xftf()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>chir_re</p></td>
<td><p>array</p></td>
<td><p><span class="math notranslate nohighlight">\(\rm Re[\chi(R)]\)</span></p></td>
<td><p><a class="reference internal" href="xafsft.html#xftf" title="xftf"><code class="xref py py-func docutils literal notranslate"><span class="pre">xftf()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>chir_im</p></td>
<td><p>array</p></td>
<td><p><span class="math notranslate nohighlight">\(\rm Im[\chi(R)]\)</span></p></td>
<td><p><a class="reference internal" href="xafsft.html#xftf" title="xftf"><code class="xref py py-func docutils literal notranslate"><span class="pre">xftf()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>rwin</p></td>
<td><p>array</p></td>
<td><p><span class="math notranslate nohighlight">\(\Omega(R)\)</span></p></td>
<td><p><a class="reference internal" href="xafsft.html#xftr" title="xftr"><code class="xref py py-func docutils literal notranslate"><span class="pre">xftr()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>q</p></td>
<td><p>array</p></td>
<td><p><span class="math notranslate nohighlight">\(q\)</span></p></td>
<td><p><a class="reference internal" href="xafsft.html#xftr" title="xftr"><code class="xref py py-func docutils literal notranslate"><span class="pre">xftr()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>chiq</p></td>
<td><p>array</p></td>
<td><p><span class="math notranslate nohighlight">\(\chi(q)\)</span> (complex)</p></td>
<td><p><a class="reference internal" href="xafsft.html#xftr" title="xftr"><code class="xref py py-func docutils literal notranslate"><span class="pre">xftr()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>chiq_mag</p></td>
<td><p>array</p></td>
<td><p><span class="math notranslate nohighlight">\(|\chi(q)|\)</span></p></td>
<td><p><a class="reference internal" href="xafsft.html#xftr" title="xftr"><code class="xref py py-func docutils literal notranslate"><span class="pre">xftr()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>chiq_re</p></td>
<td><p>array</p></td>
<td><p><span class="math notranslate nohighlight">\(\rm Re[\chi(q)]\)</span></p></td>
<td><p><a class="reference internal" href="xafsft.html#xftr" title="xftr"><code class="xref py py-func docutils literal notranslate"><span class="pre">xftr()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>chiq_im</p></td>
<td><p>array</p></td>
<td><p><span class="math notranslate nohighlight">\(\rm Im[\chi(q)]\)</span></p></td>
<td><p><a class="reference internal" href="xafsft.html#xftr" title="xftr"><code class="xref py py-func docutils literal notranslate"><span class="pre">xftr()</span></code></a></p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>where <span class="math notranslate nohighlight">\(q\)</span>, <span class="math notranslate nohighlight">\(\chi(q)\)</span>, and so on indicates back-transformed <span class="math notranslate nohighlight">\(k\)</span>.</p>
<p>The XAFS functions encourage following this convention, in that they are consistent in wanting
<span class="math notranslate nohighlight">\(\chi(k)\)</span> to be represented by the two arrays <code class="docutils literal notranslate"><span class="pre">GROUP.k</span></code> and <code class="docutils literal notranslate"><span class="pre">GROUP.chi</span></code></p>
<div class="section" id="group-argument-and-sys-xafsgroup">
<span id="set-xafs-group"></span><h3><span class="section-number">12.1.1.1. </span><cite>group</cite> argument and <code class="docutils literal notranslate"><span class="pre">_sys.xafsGroup</span></code><a class="headerlink" href="#group-argument-and-sys-xafsgroup" title="Permalink to this headline">¶</a></h3>
<p>The XAFS functions need to write outputs to some group – there are simply
too many outputs to return and expect you to manage.  To better accomodate
this, all functions take a <cite>group</cite> argument, which is used as the group
into which results are written.  This gives a convenient way to manage the
results of the different analysis steps, but gets tedious to provide this
argument repeatedly when working with a particular data set.</p>
<p>For XAFS analysis, there is also a special group, <code class="docutils literal notranslate"><span class="pre">_sys.xafsGroup</span></code> that
is used as the default group to write outputs to if no <cite>group</cite> argument is
supplied.  In addition, when an explicit <cite>group</cite> argument is given,
<code class="docutils literal notranslate"><span class="pre">_sys.xafsGroup</span></code> is set to this group.  In short, the <code class="docutils literal notranslate"><span class="pre">_sys.xafsGroup</span></code>
will be used as the “current, default group”.  This means that when working
with a set of XAFS data all contained within a single group (which is
expected to be the normal case), the <cite>group</cite> argument does not need to be
typed repeatedly.</p>
<p>Because this uses a global group in the Larch interpreter, this convention
works from with the Larch language, but does not work from plain Python
unless an instance of a Larch session is passed into the <cite>larch.xafs</cite>
function using the <cite>_larch</cite> argument.</p>
</div>
<div class="section" id="first-argument-group-convention">
<span id="first-argument-group"></span><h3><span class="section-number">12.1.1.2. </span>First Argument Group convention<a class="headerlink" href="#first-argument-group-convention" title="Permalink to this headline">¶</a></h3>
<p>Since the XAFS functions need to write outputs to some group and will
generally work with groups that contain data following <a class="reference internal" href="#xafsnames-table"><span class="std std-ref">Table of
Conventional Names for an XAFS Group</span></a>, most of the XAFS
functions follow what is called the <strong>First Argument Group</strong> convention.
This convention gives a simple approach when working with groups of XAFS
data and it is worth understanding and using this for most work with the
XAFS work.  This convention is built on the <code class="docutils literal notranslate"><span class="pre">_sys.xafsGroup</span></code> convention
discussed above but is even easier to use.</p>
<p>While the XAFS functions can take arrays of data as the first two arguments
most work will have these arrays in a single group with array names that
follows the conventions above.  As an example, the most general use of the
<a class="reference internal" href="autobk.html#autobk" title="autobk"><code class="xref py py-func docutils literal notranslate"><span class="pre">autobk()</span></code></a> function takes an array of energy as the first argument, an
array of mu as the second argument, and supplyng an output group for
placing all the arrays and data calculated within the function.  That is,
the most general use would look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">autobk</span><span class="p">(</span><span class="n">energy</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">dat</span><span class="p">,</span> <span class="n">rbkg</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">....</span><span class="p">)</span>
</pre></div>
</div>
<p>Of course, most usage will actually want to use <cite>energy</cite> and <cite>mu</cite> arrays
from the same group, and use that group as the output group, so that all
data stays contained within the same group.  That would make the call above
look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">autobk</span><span class="p">(</span><span class="n">dat</span><span class="o">.</span><span class="n">energy</span><span class="p">,</span> <span class="n">dat</span><span class="o">.</span><span class="n">mu</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">dat</span><span class="p">,</span> <span class="n">rbkg</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">....</span><span class="p">)</span>
</pre></div>
</div>
<p>where the group name <cite>dat</cite> is repeated three times.</p>
<p>The First Argument Group convention allows this to be written as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">autobk</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span> <span class="n">rbkg</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">....</span><span class="p">)</span>
</pre></div>
</div>
<p>That is, as long as the Group <cite>dat</cite> follows the XAFS naming conventions
(for <a class="reference internal" href="autobk.html#autobk" title="autobk"><code class="xref py py-func docutils literal notranslate"><span class="pre">autobk()</span></code></a> that it has an energy array named <cite>energy</cite> and
absorbance array named <cite>mu</cite>) the two forms above are equivalent.  All the
XAFS functions follow this convention and use a consistent set of attribute
names (see <a class="reference internal" href="#xafsnames-table"><span class="std std-ref">Table of Conventional Names for an XAFS Group</span></a>).  This convention nearly makes the Larch XAFS routines
into object-oriented, or in this case <strong>Group oriented</strong>, set of functions
that interact in a coherent and predictable way on an XAFS dataset.</p>
</div>
</div>
<div class="section" id="plotting-macros-for-xafs">
<h2><span class="section-number">12.1.2. </span>Plotting Macros for XAFS<a class="headerlink" href="#plotting-macros-for-xafs" title="Permalink to this headline">¶</a></h2>
<p>XAFS analysis often uses several different standard views of the data arrays
for <span class="math notranslate nohighlight">\(\mu(E)\)</span>, <span class="math notranslate nohighlight">\(\chi(k)\)</span>, and <span class="math notranslate nohighlight">\(\chi(R)\)</span>.  Larch’s plotting
capabilities provide wide flexibility in how plots can be done.  While that
flexibility can be useful in general, within the narrow scope of plotting
XAFS data, being able to easily create consistent plots with reasonable
defaults produces results that are easier to digest and understand.</p>
<p>The macros described here attempt to provide that functionality of
easy-to-use standard plotting macros. In particular, they automatically
handle typesetting the labels for the plot axes in a consistent manner, and
assign consistent labels to the different curves shown.  The results are also
easily extended, so that you can add curves, annotations, etc.  Many of the
examples in the following sections in this chapter make use of these macros.</p>
<div class="section" id="plot-mu">
<h3><span class="section-number">12.1.2.1. </span><a class="reference internal" href="#plot_mu" title="plot_mu"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_mu()</span></code></a><a class="headerlink" href="#plot-mu" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="plot_mu">
<code class="sig-name descname">plot_mu</code><span class="sig-paren">(</span><em class="sig-param">dgroup</em>, <em class="sig-param">norm=False</em>, <em class="sig-param">deriv=False</em>, <em class="sig-param">show_pre=False</em>, <em class="sig-param">show_post=False</em>, <em class="sig-param">show_e0=False</em>, <em class="sig-param">emin=None</em>, <em class="sig-param">emax=None</em>, <em class="sig-param">label=None</em>, <em class="sig-param">new=True</em>, <em class="sig-param">win=1</em><span class="sig-paren">)</span><a class="headerlink" href="#plot_mu" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Plot <span class="math notranslate nohighlight">\(\mu(E)\)</span> for an XAFS data group in various forms</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dgroup</strong> – group of XAFS data after <a class="reference internal" href="preedge.html#pre_edge" title="pre_edge"><code class="xref py py-func docutils literal notranslate"><span class="pre">pre_edge()</span></code></a> results (see note below)</p></li>
<li><p><strong>norm</strong> – bool whether to show normalized data [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</p></li>
<li><p><strong>deriv</strong> – bool whether to show derivative of XAFS data [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</p></li>
<li><p><strong>show_pre</strong> – bool whether to show pre-edge curve [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</p></li>
<li><p><strong>show_post</strong> – bool whether to show post-edge curve [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</p></li>
<li><p><strong>show_e0</strong> – bool whether to show E0 [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</p></li>
<li><p><strong>show_deriv</strong> – bool whether to show deriv together with mu [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</p></li>
<li><p><strong>emin</strong> – min energy to show, relative to E0 [<code class="docutils literal notranslate"><span class="pre">None</span></code>, start of data]</p></li>
<li><p><strong>emax</strong> – max energy to show, relative to E0 [<code class="docutils literal notranslate"><span class="pre">None</span></code>, end of data]</p></li>
<li><p><strong>label</strong> – string for label [<code class="docutils literal notranslate"><span class="pre">None</span></code>:  ‘mu’, ‘dmu/dE’, or ‘mu norm’]</p></li>
<li><p><strong>new</strong> – bool whether to start a new plot [<code class="docutils literal notranslate"><span class="pre">True</span></code>]</p></li>
<li><p><strong>win</strong> – integer plot window to use [1]</p></li>
</ul>
</dd>
</dl>
<p>The input data group must have the following attributes: <cite>energy</cite>, <cite>mu</cite>,
<cite>norm</cite>, <cite>e0</cite>, <cite>pre_edge</cite>, <cite>edge_step</cite>, <cite>filename</cite></p>
</dd></dl>

</div>
<div class="section" id="plot-bkg">
<h3><span class="section-number">12.1.2.2. </span><a class="reference internal" href="#plot_bkg" title="plot_bkg"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_bkg()</span></code></a><a class="headerlink" href="#plot-bkg" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="plot_bkg">
<code class="sig-name descname">plot_bkg</code><span class="sig-paren">(</span><em class="sig-param">dgroup</em>, <em class="sig-param">norm=True</em>, <em class="sig-param">emin=None</em>, <em class="sig-param">emax=None</em>, <em class="sig-param">show_e0=False</em>, <em class="sig-param">label=None</em>, <em class="sig-param">new=True</em>, <em class="sig-param">win=1</em><span class="sig-paren">)</span><a class="headerlink" href="#plot_bkg" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot <span class="math notranslate nohighlight">\(\mu(E)\)</span> and background <span class="math notranslate nohighlight">\(\mu_0(E)\)</span> for XAFS data group</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dgroup</strong> – group of XAFS data after autobk() results (see note below)</p></li>
<li><p><strong>norm</strong> – bool whether to show normalized data [<code class="docutils literal notranslate"><span class="pre">True</span></code>]</p></li>
<li><p><strong>emin</strong> – min energy to show, relative to <span class="math notranslate nohighlight">\(E_0\)</span> [<code class="docutils literal notranslate"><span class="pre">None</span></code>, start of data]</p></li>
<li><p><strong>emax</strong> – max energy to show, relative to <span class="math notranslate nohighlight">\(E_0\)</span> [<code class="docutils literal notranslate"><span class="pre">None</span></code>, end of data]</p></li>
<li><p><strong>show_e0</strong> – bool whether to show E0 [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</p></li>
<li><p><strong>label</strong> – string for label [<code class="docutils literal notranslate"><span class="pre">None</span></code>:  ‘mu’]</p></li>
<li><p><strong>new</strong> – bool whether to start a new plot [<code class="docutils literal notranslate"><span class="pre">True</span></code>]</p></li>
<li><p><strong>win</strong> – integer plot window to use [1]</p></li>
</ul>
</dd>
</dl>
<p>The input data group must have the following attributes: <cite>energy</cite>, <cite>mu</cite>,
<cite>bkg</cite>, <cite>norm</cite>, <cite>e0</cite>, <cite>pre_edge</cite>, <cite>edge_step</cite>, <cite>filename</cite></p>
</dd></dl>

</div>
<div class="section" id="plot-chik">
<h3><span class="section-number">12.1.2.3. </span><a class="reference internal" href="#plot_chik" title="plot_chik"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_chik()</span></code></a><a class="headerlink" href="#plot-chik" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="plot_chik">
<code class="sig-name descname">plot_chik</code><span class="sig-paren">(</span><em class="sig-param">dgroup</em>, <em class="sig-param">kweight=None</em>, <em class="sig-param">kmax=None</em>, <em class="sig-param">show_window=True</em>, <em class="sig-param">label=None</em>, <em class="sig-param">new=True</em>, <em class="sig-param">win=1</em><span class="sig-paren">)</span><a class="headerlink" href="#plot_chik" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot k-weighted <span class="math notranslate nohighlight">\(\chi(k)\)</span> for XAFS data group</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dgroup</strong> – group of XAFS data after autobk() results (see note below)</p></li>
<li><p><strong>kweight</strong> – k-weighting for plot [read from last <a class="reference internal" href="xafsft.html#xftf" title="xftf"><code class="xref py py-func docutils literal notranslate"><span class="pre">xftf()</span></code></a>, or 0]</p></li>
<li><p><strong>kmax</strong> – max k to show [<code class="docutils literal notranslate"><span class="pre">None</span></code>, end of data]</p></li>
<li><p><strong>show_window</strong> – bool whether to also plot k-window [<code class="docutils literal notranslate"><span class="pre">True</span></code>]</p></li>
<li><p><strong>label</strong> – string for label [<code class="docutils literal notranslate"><span class="pre">None</span></code>:  ‘chi’]</p></li>
<li><p><strong>new</strong> – bool whether to start a new plot [<code class="docutils literal notranslate"><span class="pre">True</span></code>]</p></li>
<li><p><strong>win</strong> – integer plot window to use [1]</p></li>
</ul>
</dd>
</dl>
<p>The input data group must have the following attributes: <cite>k</cite>, <cite>chi</cite>,
<cite>kwin</cite>, <cite>filename</cite>.</p>
</dd></dl>

</div>
<div class="section" id="plot-chir">
<h3><span class="section-number">12.1.2.4. </span><a class="reference internal" href="#plot_chir" title="plot_chir"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_chir()</span></code></a><a class="headerlink" href="#plot-chir" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="plot_chir">
<code class="sig-name descname">plot_chir</code><span class="sig-paren">(</span><em class="sig-param">dgroup</em>, <em class="sig-param">show_mag=True</em>, <em class="sig-param">show_real=False</em>, <em class="sig-param">show_imag=False</em>, <em class="sig-param">rmax=None</em>, <em class="sig-param">label=True</em>, <em class="sig-param">new=True</em>, <em class="sig-param">win=1</em><span class="sig-paren">)</span><a class="headerlink" href="#plot_chir" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot <span class="math notranslate nohighlight">\(\chi(R)\)</span> for XAFS data group</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dgroup</strong> – group of XAFS data after xftf() results (see note below)</p></li>
<li><p><strong>show_mag</strong> – bool whether to plot <span class="math notranslate nohighlight">\(|\chi(R)|\)</span> [<code class="docutils literal notranslate"><span class="pre">True</span></code>]</p></li>
<li><p><strong>show_real</strong> – bool whether to plot <span class="math notranslate nohighlight">\(Re[\chi(R)]\)</span> [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</p></li>
<li><p><strong>show_imag</strong> – bool whether to plot <span class="math notranslate nohighlight">\(Im[\chi(R)]\)</span> [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</p></li>
<li><p><strong>rmax</strong> – max R to show [<code class="docutils literal notranslate"><span class="pre">None</span></code>, end of data]</p></li>
<li><p><strong>label</strong> – string for label [<code class="docutils literal notranslate"><span class="pre">None</span></code>:  ‘chir’]</p></li>
<li><p><strong>new</strong> – bool whether to start a new plot [<code class="docutils literal notranslate"><span class="pre">True</span></code>]</p></li>
<li><p><strong>win</strong> – integer plot window to use [1]</p></li>
</ul>
</dd>
</dl>
<p>The input data group must have the following attributes: <cite>r</cite>,
<cite>chir_mag</cite>, <cite>chir_im</cite>, <cite>chir_re</cite>, <cite>kweight</cite>, <cite>filename</cite></p>
</dd></dl>

</div>
<div class="section" id="plot-chifit">
<h3><span class="section-number">12.1.2.5. </span><a class="reference internal" href="#plot_chifit" title="plot_chifit"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_chifit()</span></code></a><a class="headerlink" href="#plot-chifit" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="plot_chifit">
<code class="sig-name descname">plot_chifit</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">kmin=0</em>, <em class="sig-param">kmax=None</em>, <em class="sig-param">rmax=None</em>, <em class="sig-param">show_mag=True</em>, <em class="sig-param">show_real=False</em>, <em class="sig-param">show_imag=False</em>, <em class="sig-param">new=True</em>, <em class="sig-param">win=1</em><span class="sig-paren">)</span><a class="headerlink" href="#plot_chifit" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot k-weighted <span class="math notranslate nohighlight">\(\chi(k)\)</span> and <span class="math notranslate nohighlight">\(\chi(R)\)</span> for fit to feffit dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> – feffit dataset, after running <code class="xref py py-func docutils literal notranslate"><span class="pre">feffit()</span></code>.</p></li>
<li><p><strong>kmin</strong> – min k to show [0]</p></li>
<li><p><strong>kmax</strong> – max k to show [<code class="docutils literal notranslate"><span class="pre">None</span></code>, end of data]</p></li>
<li><p><strong>rmax</strong> – max R to show [<code class="docutils literal notranslate"><span class="pre">None</span></code>, end of data]</p></li>
<li><p><strong>show_mag</strong> – bool whether to plot <span class="math notranslate nohighlight">\(|chi(R)|\)</span> [<code class="docutils literal notranslate"><span class="pre">True</span></code>]</p></li>
<li><p><strong>show_real</strong> – bool whether to plot <span class="math notranslate nohighlight">\(Re[\)</span> [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</p></li>
<li><p><strong>show_imag</strong> – bool whether to plot <span class="math notranslate nohighlight">\(Im[\chi(R)]\)</span> [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</p></li>
<li><p><strong>new</strong> – bool whether to start a new plot [<code class="docutils literal notranslate"><span class="pre">True</span></code>]</p></li>
<li><p><strong>win</strong> – integer plot window to use [1]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="plot-path-k">
<h3><span class="section-number">12.1.2.6. </span><a class="reference internal" href="#plot_path_k" title="plot_path_k"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_path_k()</span></code></a><a class="headerlink" href="#plot-path-k" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="plot_path_k">
<code class="sig-name descname">plot_path_k</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">ipath</em>, <em class="sig-param">kmin=0</em>, <em class="sig-param">kmax=None</em>, <em class="sig-param">offset=0</em>, <em class="sig-param">label=None</em>, <em class="sig-param">new=False</em>, <em class="sig-param">win=1</em>, <em class="sig-param">**kws</em><span class="sig-paren">)</span><a class="headerlink" href="#plot_path_k" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot k-weighted <span class="math notranslate nohighlight">\(\chi(k)\)</span> for a single Path of a feffit dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> – feffit dataset, after running <code class="xref py py-func docutils literal notranslate"><span class="pre">feffit()</span></code></p></li>
<li><p><strong>ipath</strong> – index of path, starting count at 0 [0]</p></li>
<li><p><strong>kmin</strong> – min k to show [0]</p></li>
<li><p><strong>kmax</strong> – max k to show [<code class="docutils literal notranslate"><span class="pre">None</span></code>, end of data]</p></li>
<li><p><strong>offset</strong> – vertical offset to use for plot [0]</p></li>
<li><p><strong>label</strong> – path label [‘path I’]</p></li>
<li><p><strong>new</strong> – bool whether to start a new plot [<code class="docutils literal notranslate"><span class="pre">True</span></code>]</p></li>
<li><p><strong>win</strong> – integer plot window to use [1]</p></li>
<li><p><strong>kws</strong> – additional keyword arguments are passed to plot()</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="plot-path-r">
<h3><span class="section-number">12.1.2.7. </span><a class="reference internal" href="#plot_path_r" title="plot_path_r"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_path_r()</span></code></a><a class="headerlink" href="#plot-path-r" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="plot_path_r">
<code class="sig-name descname">plot_path_r</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">ipath</em>, <em class="sig-param">rmax=None</em>, <em class="sig-param">offset=0</em>, <em class="sig-param">label=None</em>, <em class="sig-param">show_mag=True</em>, <em class="sig-param">show_real=False</em>, <em class="sig-param">show_imag=True</em>, <em class="sig-param">new=False</em>, <em class="sig-param">win=1</em>, <em class="sig-param">**kws</em><span class="sig-paren">)</span><a class="headerlink" href="#plot_path_r" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot <span class="math notranslate nohighlight">\(\chi(R)\)</span> for a single Path of a feffit dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> – feffit dataset, after running <code class="xref py py-func docutils literal notranslate"><span class="pre">feffit()</span></code></p></li>
<li><p><strong>ipath</strong> – index of path, starting count at 0 [0]</p></li>
<li><p><strong>kmax</strong> – max k to show [None, end of data]</p></li>
<li><p><strong>offset</strong> – vertical offset to use for plot [0]</p></li>
<li><p><strong>label</strong> – path label [‘path I’]</p></li>
<li><p><strong>show_mag</strong> – bool whether to plot <span class="math notranslate nohighlight">\(|\chi(R)|\)</span> [<code class="docutils literal notranslate"><span class="pre">True</span></code>]</p></li>
<li><p><strong>show_real</strong> – bool whether to plot <span class="math notranslate nohighlight">\(Re[\chi(R)]\)</span> [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</p></li>
<li><p><strong>show_imag</strong> – bool whether to plot <span class="math notranslate nohighlight">\(Im[\chi(R)]\)</span> [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</p></li>
<li><p><strong>new</strong> – bool whether to start a new plot [<code class="docutils literal notranslate"><span class="pre">True</span></code>]</p></li>
<li><p><strong>win</strong> – integer plot window to use [1]</p></li>
<li><p><strong>kws</strong> – additional keyword arguments are passed to plot()</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="plot-paths-k">
<h3><span class="section-number">12.1.2.8. </span><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_paths_k()</span></code><a class="headerlink" href="#plot-paths-k" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt>
<code class="sig-name descname">plot_paths_k(dataset, offset=-1, kmin=0, kmax=None, new=True, win=1, **kws):</code></dt>
<dd><p>Plot k-weighted <cite>chi(k)</cite> for model and all paths of a feffit dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> – feffit dataset, after running <code class="xref py py-func docutils literal notranslate"><span class="pre">feffit()</span></code></p></li>
<li><p><strong>kmin</strong> – min k to show [0]</p></li>
<li><p><strong>kmax</strong> – max k to show [<code class="docutils literal notranslate"><span class="pre">None</span></code>, end of data]</p></li>
<li><p><strong>offset</strong> – vertical offset to use for paths for plot [-1]</p></li>
<li><p><strong>new</strong> – bool whether to start a new plot [<code class="docutils literal notranslate"><span class="pre">True</span></code>]</p></li>
<li><p><strong>win</strong> – integer plot window to use [1]</p></li>
<li><p><strong>kws</strong> – additional keyword arguments are passed to plot()</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="plot-paths-r">
<h3><span class="section-number">12.1.2.9. </span><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_paths_r()</span></code><a class="headerlink" href="#plot-paths-r" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt>
<code class="sig-name descname">plot_paths_r(dataset, offset=-0.5, rmax=None, show_mag=True, show_real=False, show_imag=False, new=True, win=1, **kws):</code></dt>
<dd><p>Plot <span class="math notranslate nohighlight">\(\chi(R)\)</span> for model and all paths of a feffit dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> – feffit dataset, after running func:<cite>feffit</cite></p></li>
<li><p><strong>offset</strong> – vertical offset to use for paths for plot [-0.5]</p></li>
<li><p><strong>rmax</strong> – max R to show [<code class="docutils literal notranslate"><span class="pre">None</span></code>, end of data]</p></li>
<li><p><strong>show_mag</strong> – bool whether to plot <span class="math notranslate nohighlight">\(|\chi(R)|\)</span> [T``rue``]</p></li>
<li><p><strong>show_real</strong> – bool whether to plot <span class="math notranslate nohighlight">\(Re[\chi(R)]\)</span> [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</p></li>
<li><p><strong>show_imag</strong> – bool whether to plot <span class="math notranslate nohighlight">\(Im[\chi(R)]\)</span> [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</p></li>
<li><p><strong>new</strong> – bool whether to start a new plot [<code class="docutils literal notranslate"><span class="pre">True</span></code>]</p></li>
<li><p><strong>win</strong> – integer plot window to use [1]</p></li>
<li><p><strong>kws</strong> – additional keyword arguments are passed to plot()</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="plot-prepeaks-baseline">
<h3><span class="section-number">12.1.2.10. </span><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_prepeaks_baseline()</span></code><a class="headerlink" href="#plot-prepeaks-baseline" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt>
<code class="sig-name descname">plot_prepeaks_baseline(dgroup, subtract_baseline=False, show_fitrange=True, show_peakrange=True, win=1, **kws):</code></dt>
<dd><p>Plot pre-edge peaks and baseline fit, as from <code class="xref py py-func docutils literal notranslate"><span class="pre">pre_edge_baseline()</span></code>
or XAS Viewer GUI</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dgroup</strong> – data group, after running <code class="xref py py-func docutils literal notranslate"><span class="pre">pre_edge_baseline()</span></code></p></li>
<li><p><strong>subtract_baseline</strong> – bool whether to subtract baseline for plot</p></li>
<li><p><strong>show_fitrange</strong> – bool whether to show fit range as vertical bars</p></li>
<li><p><strong>show_peakrange</strong> – bool whether to show pre-edge peak range with markers</p></li>
<li><p><strong>win</strong> – integer plot window to use [1]</p></li>
<li><p><strong>kws</strong> – additional keyword arguments are passed to plot()</p></li>
</ul>
</dd>
</dl>
<p>The <cite>dgroup</cite> group must have a <cite>prepeaks</cite> subgroup.</p>
</dd></dl>

</div>
<div class="section" id="plot-prepeaks-fit">
<h3><span class="section-number">12.1.2.11. </span><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_prepeaks_fit()</span></code><a class="headerlink" href="#plot-prepeaks-fit" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt>
<code class="sig-name descname">plot_prepeaks_fit(dgroup, show_init=False, subtract_baseline=False, show_residual=False, win=1, **kws):</code></dt>
<dd><p>Plot pre-edge peaks and fit, as XAS Viewer GUI</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dgroup</strong> – data group, after running pre-edge peak fit.</p></li>
<li><p><strong>show_init</strong> – bool whether to show initial model, before fitting</p></li>
<li><p><strong>subtract_baseline</strong> – bool whether to subtract baseline for plot</p></li>
<li><p><strong>show_residual</strong> – bool whether to show residual as a stacked plot.</p></li>
<li><p><strong>win</strong> – integer plot window to use [1]</p></li>
<li><p><strong>kws</strong> – additional keyword arguments are passed to plot()</p></li>
</ul>
</dd>
</dl>
<p>The <cite>dgroup</cite> group must have a <cite>peakfit_history</cite> subgroup. Currently,
this is automatically generated only using the XAS Viewer GUI or
scripts written (and possibly altered) by it.</p>
</dd></dl>

</div>
</div>
<div class="section" id="utility-functions-for-xafs">
<h2><span class="section-number">12.1.3. </span>Utility Functions for XAFS<a class="headerlink" href="#utility-functions-for-xafs" title="Permalink to this headline">¶</a></h2>
<p>Listed here are some general purpose functions for XAFS.</p>
<div class="section" id="ktoe-and-etok">
<h3><span class="section-number">12.1.3.1. </span><a class="reference internal" href="#ktoe" title="ktoe"><code class="xref py py-func docutils literal notranslate"><span class="pre">ktoe()</span></code></a> and <a class="reference internal" href="#etok" title="etok"><code class="xref py py-func docutils literal notranslate"><span class="pre">etok()</span></code></a><a class="headerlink" href="#ktoe-and-etok" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="etok">
<code class="sig-name descname">etok</code><span class="sig-paren">(</span><em class="sig-param">energies</em><span class="sig-paren">)</span><a class="headerlink" href="#etok" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert photo-electron energy in eV to wavenumber in <span class="math notranslate nohighlight">\(\AA^{-1}\)</span>.
energies can be a single number or array of numbers.</p>
</dd></dl>

<dl class="function">
<dt id="ktoe">
<code class="sig-name descname">ktoe</code><span class="sig-paren">(</span><em class="sig-param">wavenumbers</em><span class="sig-paren">)</span><a class="headerlink" href="#ktoe" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert photo-electron wavenumber in <span class="math notranslate nohighlight">\(\AA^{-1}\)</span> ot energy in eV.
wavenumber can be a single number or array of numbers.</p>
</dd></dl>

<p>An example use would be to print out a table of energies and <span class="math notranslate nohighlight">\(k\)</span> values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">larch</span><span class="o">&gt;</span> <span class="n">kvals</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">26</span><span class="p">)</span>
<span class="n">larch</span><span class="o">&gt;</span> <span class="n">evals</span> <span class="o">=</span> <span class="n">ktoe</span><span class="p">(</span><span class="n">kvals</span><span class="p">)</span>
<span class="n">larch</span><span class="o">&gt;</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">e</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">kvals</span><span class="p">,</span> <span class="n">evals</span><span class="p">)):</span>
<span class="n">larch</span><span class="o">&gt;</span>      <span class="nb">print</span> <span class="s2">&quot; </span><span class="si">%5.1f</span><span class="s2"> 1/Ang -&gt;  </span><span class="si">%8.2f</span><span class="s2"> eV&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">k</span> <span class="p">,</span> <span class="n">e</span><span class="p">)</span>
<span class="n">larch</span><span class="o">&gt;</span> <span class="n">endfor</span>
   <span class="mf">0.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>      <span class="mf">0.00</span> <span class="n">eV</span>
   <span class="mf">1.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>      <span class="mf">3.81</span> <span class="n">eV</span>
   <span class="mf">2.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>     <span class="mf">15.24</span> <span class="n">eV</span>
   <span class="mf">3.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>     <span class="mf">34.29</span> <span class="n">eV</span>
   <span class="mf">4.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>     <span class="mf">60.96</span> <span class="n">eV</span>
   <span class="mf">5.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>     <span class="mf">95.25</span> <span class="n">eV</span>
   <span class="mf">6.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>    <span class="mf">137.16</span> <span class="n">eV</span>
   <span class="mf">7.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>    <span class="mf">186.69</span> <span class="n">eV</span>
   <span class="mf">8.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>    <span class="mf">243.84</span> <span class="n">eV</span>
   <span class="mf">9.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>    <span class="mf">308.61</span> <span class="n">eV</span>
  <span class="mf">10.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>    <span class="mf">381.00</span> <span class="n">eV</span>
  <span class="mf">11.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>    <span class="mf">461.01</span> <span class="n">eV</span>
  <span class="mf">12.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>    <span class="mf">548.64</span> <span class="n">eV</span>
  <span class="mf">13.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>    <span class="mf">643.89</span> <span class="n">eV</span>
  <span class="mf">14.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>    <span class="mf">746.76</span> <span class="n">eV</span>
  <span class="mf">15.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>    <span class="mf">857.25</span> <span class="n">eV</span>
  <span class="mf">16.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>    <span class="mf">975.36</span> <span class="n">eV</span>
  <span class="mf">17.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>   <span class="mf">1101.08</span> <span class="n">eV</span>
  <span class="mf">18.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>   <span class="mf">1234.43</span> <span class="n">eV</span>
  <span class="mf">19.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>   <span class="mf">1375.40</span> <span class="n">eV</span>
  <span class="mf">20.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>   <span class="mf">1523.99</span> <span class="n">eV</span>
  <span class="mf">21.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>   <span class="mf">1680.20</span> <span class="n">eV</span>
  <span class="mf">22.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>   <span class="mf">1844.03</span> <span class="n">eV</span>
  <span class="mf">23.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>   <span class="mf">2015.48</span> <span class="n">eV</span>
  <span class="mf">24.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>   <span class="mf">2194.55</span> <span class="n">eV</span>
  <span class="mf">25.0</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ang</span> <span class="o">-&gt;</span>   <span class="mf">2381.24</span> <span class="n">eV</span>
</pre></div>
</div>
</div>
<div class="section" id="estimate-noise">
<h3><span class="section-number">12.1.3.2. </span><a class="reference internal" href="#estimate_noise" title="estimate_noise"><code class="xref py py-func docutils literal notranslate"><span class="pre">estimate_noise()</span></code></a><a class="headerlink" href="#estimate-noise" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="estimate_noise">
<code class="sig-name descname">estimate_noise</code><span class="sig-paren">(</span><em class="sig-param">k</em>, <em class="sig-param">chi=None</em>, <em class="sig-param">group=None</em>, <em class="sig-param">rmin=15</em>, <em class="sig-param">rmax=30</em>, <em class="sig-param">....</em><span class="sig-paren">)</span><a class="headerlink" href="#estimate_noise" title="Permalink to this definition">¶</a></dt>
<dd><p>Automatically estimate the noise level in a <span class="math notranslate nohighlight">\(\chi(k)\)</span> spectrum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k</strong> – 1-d array of <span class="math notranslate nohighlight">\(k\)</span></p></li>
<li><p><strong>chi</strong> – 1-d array of <span class="math notranslate nohighlight">\(\chi\)</span></p></li>
<li><p><strong>group</strong> – output group.</p></li>
<li><p><strong>rmin</strong> – minimum <span class="math notranslate nohighlight">\(R\)</span> value for noise estimate.</p></li>
<li><p><strong>rmax</strong> – maximum <span class="math notranslate nohighlight">\(R\)</span> value for noise estimate.</p></li>
<li><p><strong>kweight</strong> – exponent for weighting spectra by k**kweight [1]</p></li>
<li><p><strong>kmin</strong> – starting k for FT Window [0]</p></li>
<li><p><strong>kmax</strong> – ending k for FT Window  [20]</p></li>
<li><p><strong>dk</strong> – tapering parameter for FT Window [4]</p></li>
<li><p><strong>dk2</strong> – second tapering parameter for FT Window [None]</p></li>
<li><p><strong>window</strong> – name of window type [‘kaiser’]</p></li>
<li><p><strong>nfft</strong> – value to use for N_fft [2048].</p></li>
<li><p><strong>kstep</strong> – value to use for delta_k ( Ang^-1) [0.05]</p></li>
</ul>
</dd>
</dl>
<p>The method uses an XAFS Fourier transform, and many of arguments
(<strong>kmin</strong>, <strong>kmax</strong>, etc) are identical to those of <a class="reference internal" href="xafsft.html#xftf" title="xftf"><code class="xref py py-func docutils literal notranslate"><span class="pre">xftf()</span></code></a>.</p>
<p>This function follows the First Argument Group convention with arrarys named <cite>k</cite> and <cite>chi</cite>.
The following outputs are written to the supplied <strong>group</strong> (or <cite>_sys.xafsGroup</cite> if
<strong>group</strong> is not supplied):</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 82%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>attribute</p></th>
<th class="head"><p>meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>epsilon_k</p></td>
<td><p>estimated noise level in <span class="math notranslate nohighlight">\(\chi(k)\)</span>.</p></td>
</tr>
<tr class="row-odd"><td><p>epsilon_r</p></td>
<td><p>estimated noise level in <span class="math notranslate nohighlight">\(\chi(R)\)</span>.</p></td>
</tr>
<tr class="row-even"><td><p>kmax_suggest</p></td>
<td><p>suggested highest <span class="math notranslate nohighlight">\(k\)</span> value for which <span class="math notranslate nohighlight">\(|\chi(k)| &gt; \epsilon_k\)</span></p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</dd></dl>

<p>This method uses the high-R portion of <span class="math notranslate nohighlight">\(\chi(R)\)</span> (between <strong>rmin</strong>
and <strong>rmax</strong>) as a measure of the noise level in the <span class="math notranslate nohighlight">\(\chi(R)\)</span> data
and uses Parseval’s theorem to convert this noise level to that in
<span class="math notranslate nohighlight">\(\chi(k)\)</span>.  This method implicitly assumes that there is no signal in
the high-R portion of the spectrum, and that the noise in the spectrum is
“white” (independent of <span class="math notranslate nohighlight">\(R\)</span>) .  Each of these assumptions can be
legitimately questioned.  Then again, making the assertion that these
assumptions are invalid and disregarding the estimated noise level here
would require knowledge of the noise in an XAFS spectrum that most users do
not have.  At the very least, this estimate should be be interpreted as a
minimal estimate of the noise level in <span class="math notranslate nohighlight">\(\chi(k)\)</span>.</p>
<p>The estimate for the output value <strong>kmax_suggest</strong> has a tendency to be
pessimistic in how far out the <span class="math notranslate nohighlight">\(\chi(k)\)</span> data goes before being
dominated by noise, but has the advantage of being an impartial measure of
data quality. It is particularly pessimistic for extremely good data.  Then
again, considering that the estimate for <span class="math notranslate nohighlight">\(\epsilon\)</span> is probably too
small, the estimate may not be that bad.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="preedge.html" title="12.2. XAFS: Pre-edge Subtraction, Normalization, and data treatment"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="12. XAFS Analysis"
             >previous</a> |</li>
   <li>[<a href="../index.html"> Larch</a>|</li>
   <li><a href="../getting_started.html"> Getting Started</a>|</li>
   <li><a href="index.html">XAFS Analysis</a>|</li>
   <li><a href="../xray/index.html">X-ray Databases</a>|</li>
   <li><a href="../xrf/index.html">XRF Analysis</a>|</li>
   <li><a href="../fitting/index.html">Curve Fitting</a>|</li>

          <li class="nav-item nav-item-1"><a href="index.html" ><span class="section-number">12. </span>XAFS Analysis</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright Matthew Newville, The University of Chicago, 2020.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.3.1.
    </div>
  </body>
</html>