

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>8.5. Dealing With Errors &#8212; xraylarch 0.9.47 documentation</title>
    <link rel="stylesheet" href="../_static/larchdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="8.6. Writing Functions or Procedures" href="procedures.html" />
    <link rel="prev" title="8.4. Conditional Execution and Flow Control" href="flow.html" />

<script async src="https://badge.dimensions.ai/badge.js" charset="utf-8"></script>

<script type="text/x-mathjax-config">
   MathJax.Hub.Config({ "TeX": {Macros: {AA : "{\\unicode{x212B}}"}}, "HTML-CSS": {scale: 90}});
</script>


  </head><body>
<div style=" color: #c5daba;  text-align: left; height:65px; padding: 0px">
<table border=0>
  <tr>
    <td width=20%>
	<a href="../index.html">
	 <img src="../_static/larchcones.png" height=50px alt="larchcones"/></a>
    </td>
    <td width=75% padding=0>
      <font size=+2>
	<a href="../index.html" style="color:#772211">
	  Larch: Data Analysis Tools for X-ray Spectroscopy
	</a>
      </font>
    </td>
   </tr></table>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="procedures.html" title="8.6. Writing Functions or Procedures"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="flow.html" title="8.4. Conditional Execution and Flow Control"
             accesskey="P">previous</a> |</li>
   <li>[<a href="../index.html"> Larch</a>|</li>
   <li><a href="../getting_started.html"> Getting Started</a>|</li>
   <li><a href="../xafs/index.html">XAFS Analysis</a>|</li>
   <li><a href="../xray/index.html">X-ray Databases</a>|</li>
   <li><a href="../xrf/index.html">XRF Analysis</a>|</li>
   <li><a href="../fitting/index.html">Curve Fitting</a>|</li>

          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U"><span class="section-number">8. </span>Larch Macro Language Tutorial</a> &#187;</li> 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">8.5. Dealing With Errors</a><ul>
<li><a class="reference internal" href="#syntax-errors">8.5.1. Syntax Errors</a></li>
<li><a class="reference internal" href="#exceptions">8.5.2. Exceptions</a></li>
<li><a class="reference internal" href="#try-and-except">8.5.3. Try and Except</a></li>
<li><a class="reference internal" href="#raising-your-own-exceptions">8.5.4. Raising your own exceptions</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="flow.html"
                        title="previous chapter"><span class="section-number">8.4. </span>Conditional Execution and Flow Control</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="procedures.html"
                        title="next chapter"><span class="section-number">8.6. </span>Writing Functions or Procedures</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/tutorial/errors.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="dealing-with-errors">
<h1><span class="section-number">8.5. </span>Dealing With Errors<a class="headerlink" href="#dealing-with-errors" title="Permalink to this headline">¶</a></h1>
<p>When an error exists in the syntax of your script, or an error happens when
running your script, an <em>Error</em> or <em>Exception</em> is generated, and the
execution of your script is stopped.</p>
<div class="section" id="syntax-errors">
<h2><span class="section-number">8.5.1. </span>Syntax Errors<a class="headerlink" href="#syntax-errors" title="Permalink to this headline">¶</a></h2>
<p>Syntax errors result from incomplete or ill-formed larch syntax.  For
example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">larch</span><span class="o">&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">+</span>
<span class="ne">SyntaxError</span><span class="p">:</span> <span class="n">invalid</span> <span class="n">syntax</span>
<span class="n">x</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">+</span>

    <span class="n">x</span> <span class="o">=</span> <span class="mi">3</span>  <span class="o">+</span>
</pre></div>
</div>
<p>This indicates that the Larch interpreter could not understand the meaning
of the statement ‘x = 3 +’, because it excepts a value after the ‘+’.
Syntax errors are spotted and raised before the interpreter tries to
evaluate the expression.  That is because Larch first fully parses any
statements (or block of statements if you’re entering multiple statements
or loading a script from a file) into a partially compiled, executable form
before executing.  Because of this two-step approach (first parse to intermediate
form, then execute that intermediate form), syntax errors are sometimes
referred to as a parsing errors.</p>
</div>
<div class="section" id="exceptions">
<h2><span class="section-number">8.5.2. </span>Exceptions<a class="headerlink" href="#exceptions" title="Permalink to this headline">¶</a></h2>
<p>Even if the syntax of your script is correct, the logic might not be.  In addition,
even if the logic is correct for most cases, it might not be correct for
all.  For example, certain values might cause an error run time:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">larch</span><span class="o">&gt;</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">larch</span><span class="o">&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="mf">4.0</span> <span class="o">/</span> <span class="p">(</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
<span class="ne">ZeroDivisionError</span><span class="p">(</span><span class="s1">&#39;float division&#39;</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">StdInput</span><span class="o">&gt;</span>
    <span class="nb">print</span><span class="p">(</span><span class="mf">4.0</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
          <span class="o">^^^</span>
</pre></div>
</div>
<p>which is saying that you can’t divide by 0.  This is known as a <strong>Runtime
Exception</strong>.  It might indicate a programming error, for example that you
didn’t test if the denominator was 0 before doing the division.</p>
<p>Larch (as inherited from Python) has many different types of exceptions, so
that dividing by zero, as above, is detected as a different exception from,
say, trying to open a file that doesn’t exist:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">larch</span><span class="o">&gt;</span> <span class="n">fh</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">Error</span> <span class="n">running</span> <span class="o">&lt;</span><span class="n">built</span><span class="o">-</span><span class="ow">in</span> <span class="n">function</span> <span class="nb">open</span><span class="o">&gt;</span>
<span class="ne">IOError</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;No such file or directory&#39;</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">StdInput</span><span class="o">&gt;</span>
    <span class="n">fh</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
         <span class="o">^^^</span>
</pre></div>
</div>
<p>or trying to add an integer and a string together:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">larch</span><span class="o">&gt;</span> <span class="mi">4</span> <span class="o">+</span> <span class="s1">&#39;a&#39;</span>
<span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;unsupported operand type(s) for +: &#39;int&#39; and &#39;str&#39;&quot;</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">StdInput</span><span class="o">&gt;</span>
    <span class="mi">4</span> <span class="o">+</span> <span class="s1">&#39;a&#39;</span>
</pre></div>
</div>
<p>Though they are called exceptions, such problems are fairly common when
developing programs or writing scripts.  Having a built-in way to test for
and handle different kinds of exceptions is an important part of many
modern computer languages, and Larch has this capability with
its <strong>try</strong> and <strong>except</strong> statements.</p>
</div>
<div class="section" id="try-and-except">
<h2><span class="section-number">8.5.3. </span>Try and Except<a class="headerlink" href="#try-and-except" title="Permalink to this headline">¶</a></h2>
<p>The <strong>try</strong> statement will execute a block of code and look for certain
types of exceptions.  One or more <strong>except</strong> statements can be added to
specify blocks of code to execute if the specified exception occurs.
As a simple example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">a</span><span class="o">/</span><span class="n">b</span>
<span class="k">except</span> <span class="ne">ZeroDivisionError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;saw a divide by zero!)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
<span class="c1">#endtry</span>
</pre></div>
</div>
<p>If b is not 0, x is set to the value of a/b.  If b is 0, executing <em>x =
a/b</em> will cause a ZeroDivisionError (as we saw above), so the block with
the print statement and setting x to 0 will be executed.  In either of
these cases (no exception, or a handled exception), execution will continue
as normal.  If a different problem occurs – an “unhandled exception” –
such as the case if <em>a</em> holds a string value with <em>b</em> holds an integer, then
execution will stop and the corresponding exception will be raised.</p>
<p>There can be several <strong>except</strong> statements for each <strong>try</strong> statement,
to check for multiple types of problems.  These will be checked in order.  For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">a</span><span class="o">/</span><span class="n">b</span>
<span class="k">except</span> <span class="ne">ZeroDivisionError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;saw a divide by zero!)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;a and b are of different types -- can&#39;t divide&quot;</span><span class="p">)</span>
<span class="c1">#endtry</span>
<span class="o">&lt;</span><span class="n">more</span> <span class="n">statements</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>It is sometimes useful to run certain code only when a looked-for error has
not occurred.  For example, it is often agood idea to test when opening a
file for IOError (which covers a range of issues such as the file not being
found), and only reading that file if it actually opened.  For example, to
read in a file into a list of lines, the recommended practice is to do:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">fh</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;cannot open file </span><span class="si">%s</span><span class="s1">!&#39;</span> <span class="o">%</span> <span class="n">filename</span><span class="p">)</span>
    <span class="n">datalines</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">datalines</span> <span class="o">=</span> <span class="n">fh</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="n">fh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="c1">#endtry</span>
<span class="o">&lt;</span><span class="n">operate</span> <span class="n">on</span> <span class="n">datalines</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>There is a very large number of exception types built into Larch, all
inherited from Python.   See the standard Python documentation for more
details.</p>
</div>
<div class="section" id="raising-your-own-exceptions">
<h2><span class="section-number">8.5.4. </span>Raising your own exceptions<a class="headerlink" href="#raising-your-own-exceptions" title="Permalink to this headline">¶</a></h2>
<p>In certain cases, you may want to cause an exception to occur.  This need is
most likely to happen when writing your own procedures, and want to ensure
that the input arguments can be handled correctly.</p>
<p>To cause an exception, you use the <strong>raise</strong> statement, and you are said to
be “raising an exception”:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">larch</span><span class="o">&gt;</span> <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;wrong data type&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="procedures.html" title="8.6. Writing Functions or Procedures"
             >next</a> |</li>
        <li class="right" >
          <a href="flow.html" title="8.4. Conditional Execution and Flow Control"
             >previous</a> |</li>
   <li>[<a href="../index.html"> Larch</a>|</li>
   <li><a href="../getting_started.html"> Getting Started</a>|</li>
   <li><a href="../xafs/index.html">XAFS Analysis</a>|</li>
   <li><a href="../xray/index.html">X-ray Databases</a>|</li>
   <li><a href="../xrf/index.html">XRF Analysis</a>|</li>
   <li><a href="../fitting/index.html">Curve Fitting</a>|</li>

          <li class="nav-item nav-item-1"><a href="index.html" ><span class="section-number">8. </span>Larch Macro Language Tutorial</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright Matthew Newville, The University of Chicago, 2020.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.3.1.
    </div>
  </body>
</html>