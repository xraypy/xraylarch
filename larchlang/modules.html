
<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>10.7. Running Larch Scripts, and Modules &#8212; xraylarch 2024.12.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/larchdoc.css?v=dfcb3266" />
    
    <script src="../_static/documentation_options.js?v=c7e9923c"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="10.8. Builtin Functions" href="builtins.html" />
    <link rel="prev" title="10.6. Writing Functions or Procedures" href="procedures.html" />

<script async src="https://badge.dimensions.ai/badge.js" charset="utf-8"></script>

<script type="text/x-mathjax-config">
   MathJax.Hub.Config({ "TeX": {Macros: {AA : "{\\unicode{x212B}}"}}, "HTML-CSS": {scale: 90}});
</script>


  </head><body>
<div style=" color: #c5daba;  text-align: left; height:65px; padding: 0px">
<table border=0>
  <tr>
    <td width=20%>
	<a href="../index.html">
	 <img src="../_static/larchcones.png" height=50px alt="larchcones"/></a>
    </td>
    <td width=75% padding=0>
      <font size=+2>
	<a href="../index.html" style="color:#772211">
	  Larch: Data Analysis Tools for X-ray Spectroscopy
	</a>
      </font>
    </td>
   </tr></table>
</div>

    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="builtins.html" title="10.8. Builtin Functions"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="procedures.html" title="10.6. Writing Functions or Procedures"
             accesskey="P">previous</a> |</li>
   <li>[<a href="../index.html"> Larch</a>|</li>
   <li><a href="../getting_started.html"> Getting Started</a>|</li>
   <li><a href="../xafs.html">XAFS Analysis</a>|</li>
   <li><a href="../xray.html">X-ray Databases</a>|</li>
   <li><a href="../xrf.html">XRF Analysis</a>|</li>

          <li class="nav-item nav-item-1"><a href="../larchlang.html" accesskey="U"><span class="section-number">10. </span>Larch Macro Language Tutorial</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">10.7. </span>Running Larch Scripts, and Modules</a></li> 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">10.7. Running Larch Scripts, and Modules</a><ul>
<li><a class="reference internal" href="#running-a-larch-script-with-run">10.7.1. Running a larch script with <code class="xref py py-func docutils literal notranslate"><span class="pre">run()</span></code></a></li>
<li><a class="reference internal" href="#importing-a-larch-script-as-a-module">10.7.2. Importing a Larch Script as a Module</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="procedures.html"
                          title="previous chapter"><span class="section-number">10.6. </span>Writing Functions or Procedures</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="builtins.html"
                          title="next chapter"><span class="section-number">10.8. </span>Builtin Functions</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/larchlang/modules.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="running-larch-scripts-and-modules">
<span id="tutorial-modules-section"></span><h1><span class="section-number">10.7. </span>Running Larch Scripts, and Modules<a class="headerlink" href="#running-larch-scripts-and-modules" title="Link to this heading">¶</a></h1>
<p>Once you’ve done any significant amount of work with Larch, you’ll want to
save what you’ve done to a file of Larch code or a <em>script</em> and run it over
again, perhaps changing some input.  You may even want to write some
function that can be re-used – this is highly recommended, and it reduces
the amount of text to maintain and find bugs in.</p>
<p>Once you have a Larch script, there are two ways to use it with Larch.
First, you can just run it as a script.  Alternatively, you can <strong>import</strong>
it into Larch.  The distinction can be subtle, and has to with where the
variables “live” within your larch session.  We’ll discuss both
possibilities and their differences here.</p>
<section id="running-a-larch-script-with-run">
<h2><span class="section-number">10.7.1. </span>Running a larch script with <a class="reference internal" href="builtins.html#run" title="run"><code class="xref py py-func docutils literal notranslate"><span class="pre">run()</span></code></a><a class="headerlink" href="#running-a-larch-script-with-run" title="Link to this heading">¶</a></h2>
<p>If you have a Larch script, you can run it with the built-in <a class="reference internal" href="builtins.html#run" title="run"><code class="xref py py-func docutils literal notranslate"><span class="pre">run()</span></code></a>
function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># file myscript.lar</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;hello from myscript.lar!&#39;</span><span class="p">)</span>

<span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Fred&#39;</span>
<span class="n">phi</span>  <span class="o">=</span> <span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
   <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<span class="c1">#endfor</span>
<span class="c1"># end of file myscript.lar</span>
</pre></div>
</div>
<p>To run this, you simply type:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>larch&gt; run(&#39;myscript.lar&#39;)
hello from myscript.lar!
0 0.0
1 1.0
2 1.41421356237
3 1.73205080757
4 2.0
</pre></div>
</div>
<p>Again, the script can contain any Larch code, including procedure
definitions.  After running the script, any variables assigned in the
script will exist in your larch session.  For example, running the above
script, there will be variables <code class="docutils literal notranslate"><span class="pre">name</span></code>, <code class="docutils literal notranslate"><span class="pre">phi</span></code>, and <code class="docutils literal notranslate"><span class="pre">i</span></code> (and <code class="docutils literal notranslate"><span class="pre">i</span></code>
will hold the value 4), and you can access these:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">larch</span><span class="o">&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span>
<span class="mi">4</span> <span class="n">Fred</span> <span class="mf">1.61803398875</span>
</pre></div>
</div>
<p>These variables are held in the “top-level namespace”, <code class="docutils literal notranslate"><span class="pre">_main</span></code>, about which
we’ll see more below.</p>
</section>
<section id="importing-a-larch-script-as-a-module">
<h2><span class="section-number">10.7.2. </span>Importing a Larch Script as a Module<a class="headerlink" href="#importing-a-larch-script-as-a-module" title="Link to this heading">¶</a></h2>
<p>The alternative method for using the script above is to <strong>import</strong> it,
using the <code class="docutils literal notranslate"><span class="pre">import</span></code> statement:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">larch</span><span class="o">&gt;</span> <span class="kn">import</span> <span class="nn">myscript</span>
<span class="mi">0</span> <span class="mf">0.0</span>
<span class="mi">1</span> <span class="mf">1.0</span>
<span class="mi">2</span> <span class="mf">1.41421356237</span>
<span class="mi">3</span> <span class="mf">1.73205080757</span>
<span class="mi">4</span> <span class="mf">2.0</span>
</pre></div>
</div>
<p>Notice a few differences: First, the ‘.lar’ suffix was removed.  Second,
the name is not in quotes.  The content of the file is still run, and the
<code class="docutils literal notranslate"><span class="pre">print</span></code> function still prints output.  But now the variables <code class="docutils literal notranslate"><span class="pre">name</span></code>,
<code class="docutils literal notranslate"><span class="pre">phi</span></code>, and <code class="docutils literal notranslate"><span class="pre">i</span></code> are held in a group named <code class="docutils literal notranslate"><span class="pre">myscript</span></code>.  Compared to the
<a class="reference internal" href="builtins.html#run" title="run"><code class="xref py py-func docutils literal notranslate"><span class="pre">run()</span></code></a> function above, this provides better organization, as the
variable names are not in the top-level group, but in their own group,
named after the name of the module.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">import</span></code> statement is more versatile than the <a class="reference internal" href="builtins.html#run" title="run"><code class="xref py py-func docutils literal notranslate"><span class="pre">run()</span></code></a> function,
and has three important differences.  First, the <code class="docutils literal notranslate"><span class="pre">import</span></code> statement looks
for files with extensions of <code class="docutils literal notranslate"><span class="pre">.lar</span></code> or <code class="docutils literal notranslate"><span class="pre">.py</span></code>, so that you can import
either larch scripts or any python module with the <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">statement</span></code>.
This is a subtle but highly important point: <strong>any python module</strong> can be
imported directly into Larch.</p>
<p>Second, you can control what is actually imported, and where it goes.  For
the above example with <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">myscript</span></code>, a group called <code class="docutils literal notranslate"><span class="pre">myscript</span></code> was
created, with variables <code class="docutils literal notranslate"><span class="pre">name</span></code>, <code class="docutils literal notranslate"><span class="pre">phi</span></code>, and <code class="docutils literal notranslate"><span class="pre">i</span></code>.  If you want the
group called something else, or you want to not import everything, but only
selected elements (perhaps only one procedure or piece of data), you can
use variations on the standard Python <code class="docutils literal notranslate"><span class="pre">import</span></code> statement like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">myscript</span> <span class="k">as</span> <span class="nn">mx</span>

<span class="kn">from</span> <span class="nn">myscript</span> <span class="kn">import</span> <span class="n">name</span><span class="p">,</span> <span class="n">phi</span>

<span class="kn">from</span> <span class="nn">myscript</span> <span class="kn">import</span> <span class="n">name</span> <span class="k">as</span> <span class="n">my_name</span>
</pre></div>
</div>
<p>The first of these will create a group <code class="docutils literal notranslate"><span class="pre">mx</span></code> with elements <code class="docutils literal notranslate"><span class="pre">name</span></code>,
<code class="docutils literal notranslate"><span class="pre">phi</span></code>, and <code class="docutils literal notranslate"><span class="pre">i</span></code>.  The second will copy the values of <code class="docutils literal notranslate"><span class="pre">name</span></code> and
<code class="docutils literal notranslate"><span class="pre">phi</span></code> into the top group, and the last will copy the value of <code class="docutils literal notranslate"><span class="pre">name</span></code> to
the variable <code class="docutils literal notranslate"><span class="pre">my_name</span></code> in the top group.</p>
<p>The third important feature of <code class="docutils literal notranslate"><span class="pre">import</span></code> is that it will search for
modules outside of the current working directory.  For this, there is a
<strong>search path</strong> used to find larch modules.  The search path is held in the
system variable <code class="docutils literal notranslate"><span class="pre">_sys.path</span></code>, and can thus be set during a larch session.
By default, this starts with the current working directory (‘.’), and is
then followed by the user’s Larch module directory, which will typically
<code class="docutils literal notranslate"><span class="pre">$HOME/.larch/modules</span></code> on Unix or Mac OSX or <code class="docutils literal notranslate"><span class="pre">$USER\larch\modules</span></code> on
Windows.  If a file with the <code class="docutils literal notranslate"><span class="pre">.lar</span></code> extension is not found in one of
these three places, the standard Python rules for importing modules will be
used.</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="builtins.html" title="10.8. Builtin Functions"
             >next</a> |</li>
        <li class="right" >
          <a href="procedures.html" title="10.6. Writing Functions or Procedures"
             >previous</a> |</li>
   <li>[<a href="../index.html"> Larch</a>|</li>
   <li><a href="../getting_started.html"> Getting Started</a>|</li>
   <li><a href="../xafs.html">XAFS Analysis</a>|</li>
   <li><a href="../xray.html">X-ray Databases</a>|</li>
   <li><a href="../xrf.html">XRF Analysis</a>|</li>

          <li class="nav-item nav-item-1"><a href="../larchlang.html" ><span class="section-number">10. </span>Larch Macro Language Tutorial</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">10.7. </span>Running Larch Scripts, and Modules</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright Matthew Newville, The University of Chicago, 2022.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.4.6.
    </div>
  </body>
</html>