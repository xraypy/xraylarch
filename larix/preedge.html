
<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>5.5. Pre-edge peak fitting &#8212; xraylarch 2025.2.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/larchdoc.css?v=dfcb3266" />
    
    <script src="../_static/documentation_options.js?v=f788092f"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="6. XRFMap Viewr" href="../wxmap_viewer.html" />
    <link rel="prev" title="5.3. Pre-edge subtraction and Normalization" href="dialogs.html" />

<script async src="https://badge.dimensions.ai/badge.js" charset="utf-8"></script>

<script type="text/x-mathjax-config">
   MathJax.Hub.Config({ "TeX": {Macros: {AA : "{\\unicode{x212B}}"}}, "HTML-CSS": {scale: 90}});
</script>


  </head><body>
<div style=" color: #c5daba;  text-align: left; height:65px; padding: 0px">
<table border=0>
  <tr>
    <td width=20%>
	<a href="../index.html">
	 <img src="../_static/larchcones.png" height=50px alt="larchcones"/></a>
    </td>
    <td width=75% padding=0>
      <font size=+2>
	<a href="../index.html" style="color:#772211">
	  Larch: Data Analysis Tools for X-ray Spectroscopy
	</a>
      </font>
    </td>
   </tr></table>
</div>

    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../wxmap_viewer.html" title="6. XRFMap Viewr"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="dialogs.html" title="5.3. Pre-edge subtraction and Normalization"
             accesskey="P">previous</a> |</li>
   <li>[<a href="../index.html"> Larch</a>|</li>
   <li><a href="../getting_started.html"> Getting Started</a>|</li>
   <li><a href="../xafs.html">XAFS Analysis</a>|</li>
   <li><a href="../xray.html">X-ray Databases</a>|</li>
   <li><a href="../xrf.html">XRF Analysis</a>|</li>

          <li class="nav-item nav-item-1"><a href="../larix.html" accesskey="U"><span class="section-number">5. </span>Larix (was XAS Viewer)</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">5.5. </span>Pre-edge peak fitting</a></li> 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">5.5. Pre-edge peak fitting</a></li>
<li><a class="reference internal" href="#linear-combination-analysis">5.6. Linear Combination Analysis</a></li>
<li><a class="reference internal" href="#principal-component-and-non-negative-factor-analysis">5.7. Principal Component and Non-negative Factor Analysis</a></li>
<li><a class="reference internal" href="#linear-regression-with-lasso-and-pls-to-predict-external-variable">5.8. Linear Regression with LASSO and PLS to predict external variable</a></li>
<li><a class="reference internal" href="#exafs-processing-background-subtraction">5.9. EXAFS Processing: Background Subtraction</a></li>
<li><a class="reference internal" href="#exafs-processing-fourier-transforms">5.10. EXAFS Processing:  Fourier Transforms</a></li>
<li><a class="reference internal" href="#fitting-exafs-data-to-feff-paths">5.11. Fitting EXAFS data to Feff Paths</a></li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="dialogs.html"
                          title="previous chapter"><span class="section-number">5.3. </span>Pre-edge subtraction and Normalization</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="../wxmap_viewer.html"
                          title="next chapter"><span class="section-number">6. </span>XRFMap Viewr</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/larix/preedge.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <p>..include:: ../_config.rst</p>
<section id="pre-edge-peak-fitting">
<span id="larix-peakfit"></span><h1><span class="section-number">5.5. </span>Pre-edge peak fitting<a class="headerlink" href="#pre-edge-peak-fitting" title="Link to this heading">¶</a></h1>
<p>The “Pre-edge Peak Fit” tab (show in <a class="reference internal" href="#fig-larix-3a"><span class="std std-numref">Figure 5.5.1</span></a>) provides a
form for fitting pre-edge peaks to line shapes such as Gaussian, Lorentzian,
or Voigt functions.  This provides an easy-to-use wrapper around <a class="reference external" href="https://lmfit.github.io/lmfit-py/">lmfit</a>
and the <a class="reference internal" href="../fitting_minimize.html#minimize" title="minimize"><code class="xref py py-func docutils literal notranslate"><span class="pre">minimize()</span></code></a> function for curve-fitting with the ability to
constrain fitting Parameters.</p>
<p>Fitting of pre-edge peaks with this panel is a two step process.</p>
<p>First, one fits a “baseline” curve to account for the main absorption edge.
This baseline is modeled as a Lorentzian curve plus a line which should be
a reasonable enough approximation of the main absorption edge (say,
<span class="math notranslate nohighlight">\(4p\)</span>) so that its tail represents the background of the main edge
underneath the pre-edge peaks.</p>
<p>Fitting the baseline requires identifying energy ranges for both the main
spectrum to be fitted and the pre-edge peaks – the part of the spectrum
which should be ignored when fitting the baseline.  This is illustrated in
<a class="reference internal" href="#fig-larix-3a"><span class="std std-numref">Figure 5.5.1</span></a> and <a class="reference internal" href="#fig-larix-3b"><span class="std std-numref">Figure 5.5.2</span></a>.  Note that there
are separate ranges for the “fit range” and the “pre-edge peak” range
(illustrated with grey lines and blue circles on the plot).  The “pre-edge
peak” range should be inside the fit range so that the baseline can fit
part of the pre-edge region, at energies below the pre-edge peaks, and part
of the main absorption edge region above the pre-edge peaks.</p>
<p>Clicking “Fit baseline” will fit a baseline function and display the plot
as shown below.  The initial fit may have poorly guessed ranges for the
pre-edge peaks and fit range and may require some adjustment.  As mentioned
above, clicking on the plot will select an energy that can then be
transferred to any of the bounds energy using the corresponding pin icon
<a class="reference internal" href="../_images/pin_icon.png"><img alt="pin" src="../_images/pin_icon.png" style="width: 18pt; height: 18pt;" /></a> on the form.</p>
<div class="figure compound align-center" id="fig-larix3">
<figure class="align-center" id="id1">
<span id="fig-larix-3a"></span><a class="reference external image-reference" href="../_images/Larix_prepeaks_baseline_form.png"><img alt="../_images/Larix_prepeaks_baseline_form.png" src="../_images/Larix_prepeaks_baseline_form.png" style="width: 70%;" />
</a>
<figcaption>
<p><span class="caption-number">Figure 5.5.1 </span><span class="caption-text">Pre-edge peak Panel of Larix, showing how select regions of
pre-edge peaks for fitting a baseline.</span><a class="headerlink" href="#id1" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<figure class="align-center" id="id2">
<span id="fig-larix-3b"></span><a class="reference external image-reference" href="../_images/Larix_prepeaks_baseline_plot.png"><img alt="../_images/Larix_prepeaks_baseline_plot.png" src="../_images/Larix_prepeaks_baseline_plot.png" style="width: 60%;" />
</a>
<figcaption>
<p><span class="caption-number">Figure 5.5.2 </span><span class="caption-text">Plot of pre-edge peaks with baseline.  The grey vertical lines show the
fit range and blue circles show the boundaries of the pre-edge peak
range ignored in the baseline fit. The pink line shows the centroid of
the pre-edge peaks after removal of the baseline.</span><a class="headerlink" href="#id2" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</div><p id="fig-larix3">We will allow the baseline to be refined when fitting the peaks, so it does
not need to be modeled perfectly, but it is helpful to get a decent fit to
the baseline.  Once this baseline is satisfactorily modeled, you can add
functions to model the pre-edge peaks themselves.  Selecting one of the
“Peak Models” (typically Gaussian, Lorentzian, or Voigt) will show a new
tab in the “model components area” in the lower part of the form.  Since
the baseline consists of a Lorentzian curve and a line, there will now be 3
tabs for the 3 components of the pre-edge peak model.  The background peak
and the background line will have tabs labeled <cite>bp_</cite> and <cite>bl_</cite>,
respectively, and the added Gaussian curve will be labeled <cite>gauss1_</cite>, as
shown in <a class="reference internal" href="#fig-larix-4a"><span class="std std-numref">Figure 5.5.3</span></a>, which shows the form with 1 Gaussian
peak, and the two-component baseline.  You can add more peaks by repeatedly
selecting the peak type from the drop-down menu labeled <em>Add Component</em>.</p>
<p>Each of the tab for each functional component of the model will include a
table of the Parameters for that peak.  For example, a line will have an
<em>intercept</em> and a <em>slope</em> parameter, and most peak functions will have an
<em>amplitude</em>, <em>center</em>, and <em>sigma</em> parameters (and perhaps more).  Each of
these parameters will have a name and a value, and also have a Type
drop-down list to allow it to <em>vary</em> or stay <em>fixed</em> in the fit.  You can
also set it to be <em>constrained</em> by a simple mathematical expression of
other parameter values.  If varied, you can also set bounds on the
parameter values by using the Bounds drop-down list (to select <em>positive</em>,
<em>negative</em>, or <em>custom</em>) and/or set Min and Max values.</p>
<p>After selecting a functional form for the peak, clicking on the “Pick
Values from Data” button, and then clicking two points on the plot near the
peak of interest will fill in the form with initial values for the
parameters for that peak.  This is shown in <a class="reference internal" href="#fig-larix-4a"><span class="std std-numref">Figure 5.5.3</span></a>
which has values filled in from the “two click method”, and in
<a class="reference internal" href="#fig-larix-4b"><span class="std std-numref">Figure 5.5.4</span></a> which shows the initial Gaussian peak.  The
points you pick do not have to be very accurate, and the initial values
selected for the <cite>amplitude</cite>, <cite>center</cite>, and <cite>sigma</cite> parameters can be
modified.  You can also set bounds on any of these parameters – it is
probably a good idea to enforce the <cite>amplitude</cite> and <cite>sigma</cite> to be positive,
for example.  If using multiple peaks, it is often helpful to give
realistic energy bounds for the <cite>center</cite> of each peak, so that the peaks
don’t try to exchange.</p>
<div class="figure compound align-center" id="fig-larix4">
<figure class="align-center" id="id3">
<span id="fig-larix-4a"></span><a class="reference external image-reference" href="../_images/Larix_prepeaks_1gaussian_form.png"><img alt="../_images/Larix_prepeaks_1gaussian_form.png" src="../_images/Larix_prepeaks_1gaussian_form.png" style="width: 100%;" />
</a>
<figcaption>
<p><span class="caption-number">Figure 5.5.3 </span><span class="caption-text">Pre-edge peak Window of Larix, showing 3 components of a Gaussian
and a baseline that includes a line and Lorentzian.</span><a class="headerlink" href="#id3" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<figure class="align-center" id="id4">
<span id="fig-larix-4b"></span><a class="reference external image-reference" href="../_images/Larix_prepeaks_1gaussian_plot.png"><img alt="../_images/Larix_prepeaks_1gaussian_plot.png" src="../_images/Larix_prepeaks_1gaussian_plot.png" style="width: 60%;" />
</a>
<figcaption>
<p><span class="caption-number">Figure 5.5.4 </span><span class="caption-text">Plot of initial Gaussian guessed from the “two click method” for
modeling pre-edge peaks.</span><a class="headerlink" href="#id4" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</div><p id="fig-larix4">Once the model function is defined and initial parameters values set,
clicking the Fit Model button will perform the fit. This will bring up
a Fit Result form shown in <a class="reference internal" href="#fig-larix-5a"><span class="std std-numref">Figure 5.5.5</span></a> and an
initial plot of the data and fit as shown in <a class="reference internal" href="#fig-larix-5b"><span class="std std-numref">Figure 5.5.6</span></a>.</p>
<p>The Fit Result panel contains goodness-of-fit statistics and parameter
values and uncertainties (or standard error).  At the top portion of the
form, you can save a model to be read in and used later or export the data
and fit components to a simple column-based data file.  You can also view
the fit goodness-of-fit statistics for the fit.  There are also some
options and a button for the plot of data and fit.</p>
<p>In the lower portion of the form, you can read the values and uncertainties
for the fitting parameters and for a number of <em>derived</em> parameters,
including <cite>fit_centroid</cite> that is the (area-weighted) centroid of the
functions that comprise the pre-edge peaks (not including the baseline) and
the full-width-at-half-maximum and height of each of the peaks (note that
<cite>amplitude</cite> represents the area of the unit-normalized peak and <cite>height</cite>
represents the maximum height for a peak).  You can click on the button
labeled “Update Model with these Values” to put these best-fit values back
into the starting values on the main form.  In addition, clicking on any
variable parameter to show it correlations with other variables.  Note that
the baseline parameters <em>are</em> refined (by default) in the fit to the
pre-edge peaks.</p>
<div class="figure compound align-center" id="fig-larix5">
<figure class="align-left" id="id5">
<span id="fig-larix-5a"></span><a class="reference external image-reference" href="../_images/Larix_prepeaks_fitresult1_form.png"><img alt="../_images/Larix_prepeaks_fitresult1_form.png" src="../_images/Larix_prepeaks_fitresult1_form.png" style="width: 75%;" />
</a>
<figcaption>
<p><span class="caption-number">Figure 5.5.5 </span><span class="caption-text">Fit result frame for Pre-edge peak fit for a fit with 1 Gaussian.</span><a class="headerlink" href="#id5" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<figure class="align-center" id="id6">
<span id="fig-larix-5b"></span><a class="reference external image-reference" href="../_images/Larix_prepeaks_fitresult1_plot.png"><img alt="../_images/Larix_prepeaks_fitresult1_plot.png" src="../_images/Larix_prepeaks_fitresult1_plot.png" style="width: 60%;" />
</a>
<figcaption>
<p><span class="caption-number">Figure 5.5.6 </span><span class="caption-text">Pre-edge Peak data and best-fit with 1 Gaussian and baseline.</span><a class="headerlink" href="#id6" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</div><p id="fig-larix5">Though the plot of the fit in <a class="reference internal" href="#fig-larix-5b"><span class="std std-numref">Figure 5.5.6</span></a> does not look too
bad, we can see the fit is not perfect. Checking the “Plot with residual?”
box we get the plot in <a class="reference internal" href="#fig-larix-6"><span class="std std-numref">Figure 5.5.7</span></a> that shows the data and fit
and also the residual.  From this, we can see systematic oscillations in
the fit residual that is well above the noise level and suggests that
another peak may be needed to explain this data.  This is not too
surprising here – there are obviously two peaks in the pre-edge – but it
is does illustrate a useful way to determine when it is useful to add more
peaks.</p>
<figure class="align-center" id="id7">
<span id="fig-larix-6"></span><a class="reference external image-reference" href="../_images/Larix_prepeaks_fitresult1_residual_plot.png"><img alt="../_images/Larix_prepeaks_fitresult1_residual_plot.png" src="../_images/Larix_prepeaks_fitresult1_residual_plot.png" style="width: 55%;" />
</a>
<figcaption>
<p><span class="caption-number">Figure 5.5.7 </span><span class="caption-text">Pre-edge Peak plot of data, fit and residual.</span><a class="headerlink" href="#id7" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>Adding a second Gaussian (and maybe even a third) will greatly help this
fit.  If we add another Gaussian peak component to the fit model using the
drop-down menu of “Add component:”, select initial values for that second
Gaussian before, and re-run the fit, we’ll see the Fit Results form and
plot as shown in <a class="reference internal" href="#fig-larix-7a"><span class="std std-numref">Figure 5.5.8</span></a> and <a class="reference internal" href="#fig-larix-7b"><span class="std std-numref">Figure 5.5.9</span></a>.</p>
<div class="figure compound align-center" id="fig_larix_7">
<figure class="align-left" id="id8">
<span id="fig-larix-7a"></span><a class="reference external image-reference" href="../_images/Larix_prepeaks_fitresult2_form.png"><img alt="../_images/Larix_prepeaks_fitresult2_form.png" src="../_images/Larix_prepeaks_fitresult2_form.png" style="width: 95%;" />
</a>
<figcaption>
<p><span class="caption-number">Figure 5.5.8 </span><span class="caption-text">Fit result frame for Pre-edge peak fit for a fit with 2 Gaussians.</span><a class="headerlink" href="#id8" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<figure class="align-center" id="id9">
<span id="fig-larix-7b"></span><a class="reference external image-reference" href="../_images/Larix_prepeaks_fitresult2_plot.png"><img alt="../_images/Larix_prepeaks_fitresult2_plot.png" src="../_images/Larix_prepeaks_fitresult2_plot.png" style="width: 95%;" />
</a>
<figcaption>
<p><span class="caption-number">Figure 5.5.9 </span><span class="caption-text">Pre-edge Peak data and best-fit with 2 Gaussians and baseline.</span><a class="headerlink" href="#id9" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</div><p id="fig_larix_7">As mentioned above, fit results can be saved in two different ways, using
the “PreEdge Peaks” menu.  First, the model to set up the fit can be saved
to a <cite>.modl</cite> file and then re-read later and used for other fits. This
model file can also be read in and used with the <a class="reference external" href="https://lmfit.github.io/lmfit-py/">lmfit</a> python module for
complete scripting control.  Secondly, a fit can be <em>exported</em> to an ASCII
file that will include the text of the fit report and columns including
data, best-fit, and each of the components of the model.</p>
<p>To continue with the analysis of the data in this example,
<a class="reference internal" href="#fig-larix-7b"><span class="std std-numref">Figure 5.5.9</span></a> shows that the fit residual still has
significant structure, indicating that either another peak should be
included or that the Gaussian peak shape is not a good model for these
peaks.  In fact, using 2 Voigt functions significantly improves the fit, as
shown in <a class="reference internal" href="#fig-larix-8a"><span class="std std-numref">Figure 5.5.10</span></a>, with reduced <span class="math notranslate nohighlight">\(\chi^2\)</span> dropping
from 4.4e-6 to 3.2e-6 and similar improvements in the AIC and BIC
statistics.  To do this, the two Gaussian peaks were deleted and two Voigt
peaks added, with initial values selected with the “two click method”.</p>
<p>The fit of the pre-edge peaks is visibly improved but a systematic
variation in the residual is still seen at the high energy side of the
pre-edge peaks.  Adding a third Voigt function at around 7117 eV improves
the fit even more as shown in <a class="reference internal" href="#fig-larix-8b"><span class="std std-numref">Figure 5.5.11</span></a>.  As shown, the
scale of the residual is now 0.001, ten times better than the scale of the
fit with 1 peak shown in <a class="reference internal" href="#fig-larix-6"><span class="std std-numref">Figure 5.5.7</span></a>, and shows much less
systematic structure.  In addition, all the fit statistics are improved
despite now using 14 variables: reduced <span class="math notranslate nohighlight">\(\chi^2\)</span> becomes from 5.1e-7,
AIC is -1957 and BIC is -1917.</p>
<div class="figure compound align-center" id="fig_larix_8">
<figure class="align-left" id="id10">
<span id="fig-larix-8a"></span><a class="reference external image-reference" href="../_images/Larix_prepeaks_fitresult3_plot.png"><img alt="../_images/Larix_prepeaks_fitresult3_plot.png" src="../_images/Larix_prepeaks_fitresult3_plot.png" style="width: 95%;" />
</a>
<figcaption>
<p><span class="caption-number">Figure 5.5.10 </span><span class="caption-text">Fit result frame for Pre-edge peak fit
for a fit with 2 Voigt functions
plus the baseline.</span><a class="headerlink" href="#id10" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<figure class="align-center" id="id11">
<span id="fig-larix-8b"></span><a class="reference external image-reference" href="../_images/Larix_prepeaks_fitresult4_plot.png"><img alt="../_images/Larix_prepeaks_fitresult4_plot.png" src="../_images/Larix_prepeaks_fitresult4_plot.png" style="width: 95%;" />
</a>
<figcaption>
<p><span class="caption-number">Figure 5.5.11 </span><span class="caption-text">Pre-edge Peak data and best-fit for a fit with 3 Voigt functions plus
the baseline.</span><a class="headerlink" href="#id11" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</div></section>
<section id="linear-combination-analysis">
<span id="larix-lincombo"></span><span id="fig_larix_8"></span><h1><span class="section-number">5.6. </span>Linear Combination Analysis<a class="headerlink" href="#linear-combination-analysis" title="Link to this heading">¶</a></h1>
<p>Linear Combination Analysis is useful for modeling a XANES spectrum as a
combination of other spectra.  In this approach, one asserts that an
unknown spectrum should be a linear combination of spectra of
well-characterized samples or “standards”.  With the results from a
spectral fit, one can then conclude what fraction of atomic environments
correspond to those of each standard.  For this to work well, the XANES
data needs to be normalized consistently.</p>
<p>To use this in Larix, one selects a set of spectra for the “standards”
and “builds a model” from the selected groups for the standards, and then
fits one or more spectra from unknown samples to get the fractional weight
for each sample.  Options include:</p>
<blockquote>
<div><ul class="simple">
<li><p>allowing a single energy shift between unknown spectrum and the set
of standards.</p></li>
<li><p>trying all combination of standards.</p></li>
<li><p>forcing all weights to add to 1.0</p></li>
</ul>
</div></blockquote>
<figure class="align-center" id="id12">
<span id="fig-larix-9a"></span><a class="reference external image-reference" href="../_images/Larix_LCF_main.png"><img alt="../_images/Larix_LCF_main.png" src="../_images/Larix_LCF_main.png" style="width: 75%;" />
</a>
<figcaption>
<p><span class="caption-number">Figure 5.6.1 </span><span class="caption-text">Linear Combination Fitting, main panel</span><a class="headerlink" href="#id12" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<figure class="align-center" id="id13">
<span id="fig-larix-9b"></span><a class="reference external image-reference" href="../_images/Larix_LCF_plot.png"><img alt="../_images/Larix_LCF_plot.png" src="../_images/Larix_LCF_plot.png" style="width: 75%;" />
</a>
<figcaption>
<p><span class="caption-number">Figure 5.6.2 </span><span class="caption-text">Linear Combination Fitting, plot of result</span><a class="headerlink" href="#id13" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<figure class="align-center" id="id14">
<span id="fig-larix-9c"></span><a class="reference external image-reference" href="../_images/Larix_LCF_results.png"><img alt="../_images/Larix_LCF_results.png" src="../_images/Larix_LCF_results.png" style="width: 75%;" />
</a>
<figcaption>
<p><span class="caption-number">Figure 5.6.3 </span><span class="caption-text">Linear Combination Fitting, results panel</span><a class="headerlink" href="#id14" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</section>
<section id="principal-component-and-non-negative-factor-analysis">
<span id="larix-pca"></span><h1><span class="section-number">5.7. </span>Principal Component and Non-negative Factor Analysis<a class="headerlink" href="#principal-component-and-non-negative-factor-analysis" title="Link to this heading">¶</a></h1>
<p>Principal Component Analysis (PCA) is one of a family of numerical
techniques to reduce the number of variable components in a set of data.
There are many related techniques and procedures, and quite a bit of
nomenclature and jargon around the methods.</p>
<p>In essence, all these methods are aimed at taking a large set of similar
data and trying to determine how many independent components make up that
larger dataset.    That is, the only question PCA and related methods can
ever really answer is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>how many independent spectra make up my collection of spectra?
</pre></div>
</div>
<p>It is important to note that PCA cannot tell you what those independent
spectra represent or even what they look like.  However, you can also use
the results of PCA to ask:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>is this *other* spectrum made up of the same components as make up my collection?
</pre></div>
</div>
<figure class="align-center" id="id15">
<span id="fig-larix-10a"></span><a class="reference external image-reference" href="../_images/Larix_PCAmain_page.png"><img alt="../_images/Larix_PCAmain_page.png" src="../_images/Larix_PCAmain_page.png" style="width: 75%;" />
</a>
<figcaption>
<p><span class="caption-number">Figure 5.7.1 </span><span class="caption-text">Principal Component Analysis, main panel</span><a class="headerlink" href="#id15" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<figure class="align-center" id="id16">
<span id="fig-larix-10b"></span><a class="reference external image-reference" href="../_images/Larix_PCA_compplot.png"><img alt="../_images/Larix_PCA_compplot.png" src="../_images/Larix_PCA_compplot.png" style="width: 75%;" />
</a>
<figcaption>
<p><span class="caption-number">Figure 5.7.2 </span><span class="caption-text">Principal Component Analysis, Plot of spectral components.</span><a class="headerlink" href="#id16" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<figure class="align-center" id="id17">
<span id="fig-larix-10c"></span><a class="reference external image-reference" href="../_images/Larix_PCA_screeplot.png"><img alt="../_images/Larix_PCA_screeplot.png" src="../_images/Larix_PCA_screeplot.png" style="width: 75%;" />
</a>
<figcaption>
<p><span class="caption-number">Figure 5.7.3 </span><span class="caption-text">Principal Component Analysis, Plot of IND statistic and scree-like plot
of the importance of each component.</span><a class="headerlink" href="#id17" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<figure class="align-center" id="id18">
<span id="fig-larix-10d"></span><a class="reference external image-reference" href="../_images/Larix_PCA_targetplot.png"><img alt="../_images/Larix_PCA_targetplot.png" src="../_images/Larix_PCA_targetplot.png" style="width: 75%;" />
</a>
<figcaption>
<p><span class="caption-number">Figure 5.7.4 </span><span class="caption-text">Principal Component Analysis, Plot of target transformation – using
components to best match an unknown spectra.</span><a class="headerlink" href="#id18" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</section>
<section id="linear-regression-with-lasso-and-pls-to-predict-external-variable">
<span id="larix-regression"></span><h1><span class="section-number">5.8. </span>Linear Regression with LASSO and PLS to predict external variable<a class="headerlink" href="#linear-regression-with-lasso-and-pls-to-predict-external-variable" title="Link to this heading">¶</a></h1>
</section>
<section id="exafs-processing-background-subtraction">
<span id="larix-exafs-bkg"></span><h1><span class="section-number">5.9. </span>EXAFS Processing: Background Subtraction<a class="headerlink" href="#exafs-processing-background-subtraction" title="Link to this heading">¶</a></h1>
</section>
<section id="exafs-processing-fourier-transforms">
<span id="larix-exafs-fft"></span><h1><span class="section-number">5.10. </span>EXAFS Processing:  Fourier Transforms<a class="headerlink" href="#exafs-processing-fourier-transforms" title="Link to this heading">¶</a></h1>
</section>
<section id="fitting-exafs-data-to-feff-paths">
<span id="larix-feffit"></span><h1><span class="section-number">5.11. </span>Fitting EXAFS data to Feff Paths<a class="headerlink" href="#fitting-exafs-data-to-feff-paths" title="Link to this heading">¶</a></h1>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../wxmap_viewer.html" title="6. XRFMap Viewr"
             >next</a> |</li>
        <li class="right" >
          <a href="dialogs.html" title="5.3. Pre-edge subtraction and Normalization"
             >previous</a> |</li>
   <li>[<a href="../index.html"> Larch</a>|</li>
   <li><a href="../getting_started.html"> Getting Started</a>|</li>
   <li><a href="../xafs.html">XAFS Analysis</a>|</li>
   <li><a href="../xray.html">X-ray Databases</a>|</li>
   <li><a href="../xrf.html">XRF Analysis</a>|</li>

          <li class="nav-item nav-item-1"><a href="../larix.html" ><span class="section-number">5. </span>Larix (was XAS Viewer)</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">5.5. </span>Pre-edge peak fitting</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright Matthew Newville, The University of Chicago, 2022.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    </div>
  </body>
</html>