
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>15.1. XRF Data: MCA and ROI objects &#8212; xraylarch 0.9.71 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/larchdoc.css" />
    
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="15.2. The XRF Viewer Application" href="xrf_viewer.html" />
    <link rel="prev" title="15. X-ray Fluorescence Analysis" href="xrf.html" />

<script async src="https://badge.dimensions.ai/badge.js" charset="utf-8"></script>

<script type="text/x-mathjax-config">
   MathJax.Hub.Config({ "TeX": {Macros: {AA : "{\\unicode{x212B}}"}}, "HTML-CSS": {scale: 90}});
</script>


  </head><body>
<div style=" color: #c5daba;  text-align: left; height:65px; padding: 0px">
<table border=0>
  <tr>
    <td width=20%>
	<a href="index.html">
	 <img src="_static/larchcones.png" height=50px alt="larchcones"/></a>
    </td>
    <td width=75% padding=0>
      <font size=+2>
	<a href="index.html" style="color:#772211">
	  Larch: Data Analysis Tools for X-ray Spectroscopy
	</a>
      </font>
    </td>
   </tr></table>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="xrf_viewer.html" title="15.2. The XRF Viewer Application"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="xrf.html" title="15. X-ray Fluorescence Analysis"
             accesskey="P">previous</a> |</li>
   <li>[<a href="index.html"> Larch</a>|</li>
   <li><a href="getting_started.html"> Getting Started</a>|</li>
   <li><a href="xafs.html">XAFS Analysis</a>|</li>
   <li><a href="xray.html">X-ray Databases</a>|</li>
   <li><a href="xrf.html">XRF Analysis</a>|</li>

          <li class="nav-item nav-item-1"><a href="xrf.html" accesskey="U"><span class="section-number">15. </span>X-ray Fluorescence Analysis</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">15.1. </span>XRF Data: MCA and ROI objects</a></li> 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">15.1. XRF Data: MCA and ROI objects</a><ul>
<li><a class="reference internal" href="#creating-mca-objects">15.1.1. Creating MCA objects</a><ul>
<li><a class="reference internal" href="#read_gsemca"><code class="docutils literal notranslate"><span class="pre">read_gsemca()</span></code></a></li>
<li><a class="reference internal" href="#xrf_plot"><code class="docutils literal notranslate"><span class="pre">xrf_plot()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="xrf.html"
                          title="previous chapter"><span class="section-number">15. </span>X-ray Fluorescence Analysis</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="xrf_viewer.html"
                          title="next chapter"><span class="section-number">15.2. </span>The XRF Viewer Application</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/xrf_mca.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="xrf-data-mca-and-roi-objects">
<h1><span class="section-number">15.1. </span>XRF Data: MCA and ROI objects<a class="headerlink" href="#xrf-data-mca-and-roi-objects" title="Permalink to this heading">¶</a></h1>
<p>XRF spectra are typically measured with MCAs (Multi Channel Analyzers)
which holds an array of intensities.  Because of the long history of using
MCAs to store XRF spectra, the two concepts are often mixed, and one often
talks about MCA traces as being the same as XRF spectra.  To be sure, an
XRF spectrum <span class="math notranslate nohighlight">\(I(E)\)</span> can be represented well with an MCA trace
(intensities per bin) as long as one can convert bin number to energy.
Fortunately, most measurement systems in use have a linear relation
(calibration) between bin number and energy, and the use of an MCA trace as
an XRF spectrum is straightforward.  We will probably use the terms
interchangeably here as well.</p>
<p>Just to be clear: an XRF spectrum collected by an MCA will have a one
dimensional array of counts with a single, well-defined energy for each
bin. There will typically be between 1000 and 10,000 bins in each
spectrum.</p>
<p>An ROI (Region of Interest) is a continuous portion of the XRF spectrum,
generally representing a range of energies corresponding to a particular
peak or X-ray emission line or family of lines.   One often sums the counts
in such an ROI to give a total number of counts for that emission line.  An
MCA spectrum may have many (typically 10s) of ROIs defined for particular
emission lines.</p>
<p>In Larch, MCAs and ROIs are exposed as Groups, each with several
attributes, and some built-in functions.  For example, An MCA has arrays
for <code class="docutils literal notranslate"><span class="pre">energy</span></code> and <code class="docutils literal notranslate"><span class="pre">counts</span></code>, as well as values for <code class="docutils literal notranslate"><span class="pre">real_time</span></code> and
<code class="docutils literal notranslate"><span class="pre">live_time</span></code>, a deadtime correction factor <code class="docutils literal notranslate"><span class="pre">dt_factor</span></code>, and several
ROIs.  Each ROI has a <code class="docutils literal notranslate"><span class="pre">left</span></code> and <code class="docutils literal notranslate"><span class="pre">right</span></code> channel index, and a
<code class="xref py py-meth docutils literal notranslate"><span class="pre">roi.get_counts()</span></code> method.</p>
<section id="creating-mca-objects">
<h2><span class="section-number">15.1.1. </span>Creating MCA objects<a class="headerlink" href="#creating-mca-objects" title="Permalink to this heading">¶</a></h2>
<p>A simple way to create an MCA object is to read one from a disk file.  For
data collected at GSECARS, this can be done with the <a class="reference internal" href="#read_gsemca" title="read_gsemca"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_gsemca()</span></code></a>
function.</p>
<dl class="py function">
<dt class="sig sig-object py" id="read_gsemca">
<span class="sig-name descname"><span class="pre">read_gsemca</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#read_gsemca" title="Permalink to this definition">¶</a></dt>
<dd><p>read a GSECARS MCA spectra file, returning a Group</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> – name of GSECARS MCA file</p>
</dd>
</dl>
<p>The returned Group has the following components:</p>
<blockquote>
<div><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>component name</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>filename</p></td>
<td><p>name of file</p></td>
</tr>
<tr class="row-odd"><td><p>mcas</p></td>
<td><p>list of MCA objects for each MCA saved in the file</p></td>
</tr>
<tr class="row-even"><td><p>rois</p></td>
<td><p>list of ROIs</p></td>
</tr>
<tr class="row-odd"><td><p>environ</p></td>
<td><p>list of Environmental Variables</p></td>
</tr>
<tr class="row-even"><td><p>energy</p></td>
<td><p>array of energy values</p></td>
</tr>
<tr class="row-odd"><td><p>counts</p></td>
<td><p>array of counts, deadtime corrected and summed over MCAs</p></td>
</tr>
<tr class="row-even"><td><p>raw</p></td>
<td><p>array of counts, summed over MCAs, not corrected.</p></td>
</tr>
<tr class="row-odd"><td><p>calib</p></td>
<td><p>dictionary of calibration values</p></td>
</tr>
<tr class="row-even"><td><p>dt_factor</p></td>
<td><p>deadtime correction factor</p></td>
</tr>
<tr class="row-odd"><td><p>real_time</p></td>
<td><p>real time for data acquisition</p></td>
</tr>
<tr class="row-even"><td><p>live_time</p></td>
<td><p>live time for data acquisition</p></td>
</tr>
<tr class="row-odd"><td><p>nchans</p></td>
<td><p>number of energy points in spectra</p></td>
</tr>
<tr class="row-even"><td><p>get_roi_counts()</p></td>
<td><p>function to get counts for a named ROI</p></td>
</tr>
<tr class="row-odd"><td><p>save_mcafile()</p></td>
<td><p>function to save MCA to file</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xrf_plot">
<span class="sig-name descname"><span class="pre">xrf_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">energy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">counts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mca</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xrf_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>create an interactive window for displaying an X-ray Fluorescence spectra</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>energy</strong> – array of energy values</p></li>
<li><p><strong>counts</strong> – array of counts</p></li>
<li><p><strong>mca</strong> – MCA group (as read from <a class="reference internal" href="#read_gsemca" title="read_gsemca"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_gsemca()</span></code></a>), containing
ROI definitions, calibration values, and related data.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<p>An example plot is shown below</p>
<figure class="align-default" id="id1">
<span id="xrf-mca1"></span><a class="reference external image-reference" href="_images/xrf_display1.png"><img alt="_images/xrf_display1.png" src="_images/xrf_display1.png" style="width: 75%;" /></a>
<figcaption>
<p><span class="caption-number">Figure 15.1.1.1 </span><span class="caption-text">Example XRF Display, showing X-ray Fluorescence spectra, defined ROIs
(in red), and Periodic Table for showing predicted emission lines.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="xrf_viewer.html" title="15.2. The XRF Viewer Application"
             >next</a> |</li>
        <li class="right" >
          <a href="xrf.html" title="15. X-ray Fluorescence Analysis"
             >previous</a> |</li>
   <li>[<a href="index.html"> Larch</a>|</li>
   <li><a href="getting_started.html"> Getting Started</a>|</li>
   <li><a href="xafs.html">XAFS Analysis</a>|</li>
   <li><a href="xray.html">X-ray Databases</a>|</li>
   <li><a href="xrf.html">XRF Analysis</a>|</li>

          <li class="nav-item nav-item-1"><a href="xrf.html" ><span class="section-number">15. </span>X-ray Fluorescence Analysis</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">15.1. </span>XRF Data: MCA and ROI objects</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright Matthew Newville, The University of Chicago, 2022.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.0.1.
    </div>
  </body>
</html>