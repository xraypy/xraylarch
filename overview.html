
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>3. Larch: Motivation and Overview &mdash; larch 0.9.30 documentation</title>
    
    <link rel="stylesheet" href="_static/larchdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.9.30',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="larch 0.9.30 documentation" href="index.html" />
    <link rel="next" title="4. Larch Tutorial" href="tutorial/index.html" />
    <link rel="prev" title="2. Larch Community and Support" href="community.html" />
  <script type="text/x-mathjax-config">
     MathJax.Hub.Config({ "TeX": {Macros: {AA : "{\\unicode{x212B}}"}},
			 "HTML-CSS": {scale: 90}});
  </script>

  </head>
  <body role="document">
<div style=" color: #c5daba;  text-align: left; height:65px; padding: 0px">
<table border=1>
  <tr>
    <td width=20%>
	<a href="index.html">
	 <img src="_static/larchcones.png" height=60px alt="larchcones"/></a>
    </td>
    <td width=75% padding=0>
      <font size=+2>
	<a href="index.html" style="color:#772211">
	  Larch: Data Analysis Tools for X-ray Spectroscopy
	</a>
      </font>
    </td>
   </tr></table>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="tutorial/index.html" title="4. Larch Tutorial"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="community.html" title="2. Larch Community and Support"
             accesskey="P">previous</a> |</li>
   <li>[<a href="data/index.html">Reading Data</a>|</li>
   <li><a href="plotting/index.html">Plotting</a>|</li>
   <li><a href="fitting/index.html">Fitting Data</a>|</li>
   <li><a href="xafs/index.html">XAFS Analysis</a>|</li>
   <li><a href="xray/index.html">Xray Databases</a>|</li>
   <li><a href="xrf/index.html">XRF Analysis</a>|</li>
   <li><a href="devel/index.html">Scripting</a>]</li>
 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">3. Larch: Motivation and Overview</a><ul>
<li><a class="reference internal" href="#key-concepts-of-larch">3.1. Key Concepts of Larch</a></li>
<li><a class="reference internal" href="#capabilities">3.2. Capabilities</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="community.html"
                        title="previous chapter">2. Larch Community and Support</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="tutorial/index.html"
                        title="next chapter">4. Larch Tutorial</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/overview.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="larch-motivation-and-overview">
<h1>3. Larch: Motivation and Overview<a class="headerlink" href="#larch-motivation-and-overview" title="Permalink to this headline">¶</a></h1>
<p>Larch brings together data processing routines for synchrotron X-ray
techniques and provides high-level scripting tools for data manipulation,
visualization, and analysis.  The initial goal was to replace the Ifeffit
package for XAFS analysis in order to better deal with larger datasets,
make it easier to modify and improve XAFS analysis algorithms, and to
provide more modern data manipulation and visualization tools.
Visualization and analysis of X-ray fluorescence spatial maps and spectra
from X-ray microprobe beamlines was is a key requirement, and incorporating
tools for related techniques like X-ray standing waves and X-ray
diffraction is a high priority.  Larch also makes it easy to bring
visualization, processing, and analysis routines with data collection
processes to give a more seamless workflow that spans data collection and
analysis, using core functionality that can be scripted and GUIs built on
top of these core functions.  While Larch is a work in progress, it has
already met most of these initial goals.</p>
<p>Larch is written in Python, a free, general-purpose interpreted language
known for its clear syntax and readability.  Python has become quite
popular in a range of scientific disciplines due to many well-designed an
supported libraries, including <a class="reference external" href="http://numpy.scipy.org/">numpy</a>, <a class="reference external" href="http://scipy.org/">scipy</a>, <a class="reference external" href="http://code.google.com/p/h5py/">h5py</a>, and
<a class="reference external" href="http://matplotlib.org/">matplotlib</a>, and is being adopted by many groups in the synchrotron X-ray
community.  Being able to build on existing tools and tap into a large pool
of scientists who are able and willing to work in Python was seen as a huge
benefit in the development of Larch.</p>
<p>The key design decision for Larch is to build a domain-specific language or
<em>macro language</em> as the framework to tie together the various
functionality.  In the synchrotron community, many scientists are familiar
with the Spec program for data collection, which is implemented as an
interactive macro language - a language that is fairly general purpose, but
also has many built in functions for interactively collecting diffraction
data.  Ifeffit was built with a similar approach, though with a much worse
macro language than Spec, though one that was complete and flexible enough
for writing complex analysis scripts, and for GUIs to be built upon this
macro language.  In some sense, Larch is an attempt to make something akin
to <em>Spec for Data Analysis</em>, in which high-level analysis and visualization
routines are readily available in a coherent scripting environment.</p>
<p>Thus, Larch provides a macro language that gives a simple command-line
interface (a Read-Eval-Print Loop).  Scripts can be written and be run
&quot;batch mode&quot;.  GUIs can be built upon Larch by simply generating the
commands, which makes it easy to separate the GUI controls layout from the
actual processing steps, so that the processing steps might be recorded and
used to make a script to reproduce or refine the steps defined from the
GUI.  In addition you can use Larch with remote-procedure calls, so that it
can be run as a service, and called from a variety of languages and from
different machines.  Finally, Larch can be used as a Python library,
nearly completely side-stepping the Larch macro language.</p>
<p>The Larch macro language is implemented in Python with Python's own
language tools, and is very closely related to Python.  It is designed have
a slightly shallower learching curve and less formal approach.  To be
clear, it is a <em>worse</em> general purpose programming language than Python,
but better suited to the tasks needed for manipulating and analyzing X-ray
data.  Since its syntax is so closely related to Python, it is possible to
write code that is both valid Python and Larch.</p>
<p>In fact, the Larch language is so closely related to Python that a few key
points should be made:</p>
<blockquote>
<div><ol class="arabic simple">
<li>All data items in Larch are really Python objects.</li>
<li>All Larch code is translated into Python and then run using builtin
Python tools.</li>
</ol>
</div></blockquote>
<p>In a sense, Larch is a dialect of Python.  Thus an understanding Larch and
Python are close to one another.  This in itself can be seen as an
advantage -- Python is a popular, open-source, language that any programmer
can easily learn.  Books and web documentation about Python are plentiful.
If you known Python, Larch will be very easy to use, and vice versa.</p>
<div class="section" id="key-concepts-of-larch">
<h2>3.1. Key Concepts of Larch<a class="headerlink" href="#key-concepts-of-larch" title="Permalink to this headline">¶</a></h2>
<p>Since Larch is intended for processing scientific data, the organization of
data is a key consideration.  There also needs to be some organization of
functions and routines.  The main concept that Larch uses to help the user
with organizing data is <strong>Group</strong>.  This is simply a container into which
any sort of data or function can be placed, including other Groups.  The
data in a Group can be accessed using a syntax of <strong>&lt;Group&gt;.&lt;Member&gt;</strong>,
as with:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">larch</span><span class="o">&gt;</span> <span class="n">my_group</span> <span class="o">=</span> <span class="n">group</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span> <span class="n">scale</span><span class="o">=</span><span class="mf">10.2</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;group 1&#39;</span><span class="p">)</span>
<span class="n">larch</span><span class="o">&gt;</span> <span class="n">my_group</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">my_group</span><span class="o">.</span><span class="n">scale</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">my_group</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
<span class="n">larch</span><span class="o">&gt;</span> <span class="n">plot</span><span class="p">(</span><span class="n">my_group</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">my_group</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">my_group</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>
</pre></div>
</div>
<p>The Group <code class="docutils literal"><span class="pre">my_group</span></code> holds data for <code class="docutils literal"><span class="pre">x</span></code>, <code class="docutils literal"><span class="pre">y</span></code>, and <code class="docutils literal"><span class="pre">title</span></code>.  Here,
the <code class="docutils literal"><span class="pre">range()</span></code> function gives an array of 11 elements ([0, 1, 2, ..., 10])
that will be held by <code class="docutils literal"><span class="pre">my_group.x</span></code>.  You can see the contents of a group
with the <a class="reference internal" href="tutorial/builtins.html#show" title="show"><code class="xref py py-func docutils literal"><span class="pre">show()</span></code></a> function:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">larch</span><span class="o">&gt;</span> <span class="n">show</span><span class="p">(</span><span class="n">my_group</span><span class="p">)</span>
<span class="o">==</span> <span class="n">Group</span> <span class="mh">0x6e15970</span><span class="p">:</span> <span class="mi">4</span> <span class="n">symbols</span> <span class="o">==</span>
  <span class="n">scale</span><span class="p">:</span> <span class="mf">10.2</span>
  <span class="n">t</span><span class="p">:</span> <span class="s1">&#39;group 1&#39;</span>
  <span class="n">x</span><span class="p">:</span> <span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,),</span> <span class="nb">type</span><span class="o">=</span><span class="n">dtype</span><span class="p">(</span><span class="s1">&#39;int32&#39;</span><span class="p">)</span><span class="o">&gt;</span>
  <span class="n">y</span><span class="p">:</span> <span class="n">array</span><span class="o">&lt;</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,),</span> <span class="nb">type</span><span class="o">=</span><span class="n">dtype</span><span class="p">(</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>which shows that this group has 4 components, and lists the components.
As the <code class="docutils literal"><span class="pre">x</span></code> and <code class="docutils literal"><span class="pre">y</span></code> members hold array, the size and datatype of the
array is shown.  Doing:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">larch</span><span class="o">&gt;</span> <span class="nb">print</span> <span class="n">my_group</span><span class="o">.</span><span class="n">y</span>
<span class="p">[</span>  <span class="mf">0.</span>           <span class="mf">8.58300405</span>   <span class="mf">9.27483375</span>   <span class="mf">1.43942408</span>  <span class="o">-</span><span class="mf">7.71938545</span>
  <span class="o">-</span><span class="mf">9.7810276</span>   <span class="o">-</span><span class="mf">2.85003808</span>   <span class="mf">6.70126331</span>  <span class="mf">10.09145412</span>   <span class="mf">4.20360855</span>
  <span class="o">-</span><span class="mf">5.54901533</span><span class="p">]</span>
</pre></div>
</div>
<p>will show the array elements.  The <code class="xref py py-func docutils literal"><span class="pre">plot()</span></code> function will show a graph
of y(x).</p>
<p>Since much of what Larch is used for is modeling or fitting small data
sets, another key organizing principle is the <strong>Parameter</strong>.  This holds a
value that you might want to be optimized in a least-squares fit.   Thus, a
Parameter can be flagged as a variable, or fixed to not be varied.  In
addition, it can be given a mathematical expression in terms of other
Parameters to determine its value as a constrained value.</p>
</div>
<div class="section" id="capabilities">
<h2>3.2. Capabilities<a class="headerlink" href="#capabilities" title="Permalink to this headline">¶</a></h2>
<p>At this writing, Larch has the following general capabilities:</p>
<blockquote>
<div><ul class="simple">
<li>a full suite of mathematical functionality, with array handling
builtin (so that functions work on full arrays).</li>
<li>a general purpose language with flow-control (for and while loops),
and conditional evaluation (if-then-else).</li>
<li>some built-in I/O functionality for ASCII files and HDF5.</li>
<li>simple line plots, with customizable line properties.</li>
<li>simple 2-D image dispays, with some rudimentary customization.</li>
<li>general-purpose minimization and curve-fitting.</li>
</ul>
</div></blockquote>
<p>For XAFS analysis in particular, Larch is able to do essentially all the data processing
and analysis steps that Ifeffit can do, including:</p>
<blockquote>
<div><ul class="simple">
<li>pre-edge background subtraction and normalization</li>
<li>background subtraction for isolating chi(k)</li>
<li>XAFS Fourier transforms</li>
<li>reading and manipulating Feff Path files</li>
<li>fitting Feff Paths to XAFS data</li>
<li>general-purpose minimization and curve-fitting.</li>
</ul>
</div></blockquote>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="tutorial/index.html" title="4. Larch Tutorial"
             >next</a> |</li>
        <li class="right" >
          <a href="community.html" title="2. Larch Community and Support"
             >previous</a> |</li>
   <li>[<a href="data/index.html">Reading Data</a>|</li>
   <li><a href="plotting/index.html">Plotting</a>|</li>
   <li><a href="fitting/index.html">Fitting Data</a>|</li>
   <li><a href="xafs/index.html">XAFS Analysis</a>|</li>
   <li><a href="xray/index.html">Xray Databases</a>|</li>
   <li><a href="xrf/index.html">XRF Analysis</a>|</li>
   <li><a href="devel/index.html">Scripting</a>]</li>
 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright Matthew Newville, The University of Chicago, 2012.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.1.
    </div>
  </body>
</html>